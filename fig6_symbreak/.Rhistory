version
version
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
debug(fileO$getPfmFiles)
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
fileO$getPfmFiles(guidefiles = allGuides, head = 15, monomericFirst = T,
exactMatchFirst = F)
options(error = recover())
fileO$getPfmFiles(guidefiles = allGuides, head = 15, monomericFirst = T,
exactMatchFirst = F)
options(error = recover)
fileO$getPfmFiles(guidefiles = allGuides, head = 15, monomericFirst = T,
exactMatchFirst = F)
recover()
cmd
system("cat ~/Nut_zhuData/SELEXphp/guide/Methylation_SELEX_Version_0.5.txt | grep -i '^OTX[0-9L-]*\\t'")
system("cat ~/Nut_zhuData/SELEXphp/guide/Methylation_SELEX_Version_0.5.txt | grep -i '^OTX[0-9L-]*\t'")
cmd=  paste0("cat ",guidefile," | grep -i '^",TFname_noNum,"[0-9L-]*\t' | ") #some TF name like HOXB2L2 NKD2-4
# if (monomeric) cmd= paste0(cmd,"grep 'mono' | ")
cmd= paste0(cmd,'perl -lne \'@all=split /\\t/; $pfm_key="$all[2]_$all[3]_$all[4]"; @allpfm= glob("~/Nut_zhuData/SELEXphp/data/pfm/shortspacek/$pfm_key*.pfm"); chomp @allpfm; print "$all[0]_$all[3]_$all[4]_$all[7]_$all[8]"."\\t".$allpfm[0] if @allpfm;\'') # some like TAGTTA40NGTG_XEPAQ_NNNNTGCTGAC
allpfms= c(allpfms,system(cmd,intern = T))
allpfms
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
traceback()
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
Sys.getenv(‘R_HOME’)
Sys.getenv("R_HOME")
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
Sys.getenv("PATH")
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
installed.packages(ggplot2)
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
library(fjComm)
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
p
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.4/2_barrier/2_barrier.R')
source('~/Nut_zhuData/Analysis/DHS_prediction/script/2017Jan_kmerplot_non_rescale.R')
source("https://bioconductor.org/biocLite.R")
biocLite("BSgenome.Mmusculus.UCSC.mm9.masked")
source('~/Nut_zhuData/Analysis/DHS_prediction/script/2017Jan_kmerplot_assign_motif_interactive.R')
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/test.R')
pacman::p_load(ROCR)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/test.R')
source('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data147/1702_MI_diag_classify.R')
source('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
allTFNames
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
col_names_mat
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
dend_reorder
col_names_mat[i]
col_names_mat
source('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
circos.clear()
source('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
View(mat)
colnames(mat)=1:ncol(mat)
View(mat)
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
traceback()
debugSource('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data147/1702_MI_diag_classify.R')
View(MI_diag_Mat)
source('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
circos.clear()
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
m
labels(dend.col)
circos.clear()
source('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
source('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
match()
mat
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
col_names_mat
dend_reorder
debugSource('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
col_names_mat[dend_reorder]
col_names_mat[dend_reorder]
source('~/Nut_zhuData/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify.R')
colMeans(MI_diag_Mat)>1.5 %>% which %>% length()
(colMeans(MI_diag_Mat)>1.5) %>% which %>% length()
(colMeans(MI_diag_Mat)>1.6) %>% which %>% length()
(colMeans(MI_diag_Mat)>1.7) %>% which %>% length()
(colMeans(MI_diag_Mat)>1.6) %>% which %>% length()
getwd()
source('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify_200.R')
source('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify_200.R')
source('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200/1702_MI_diag_classify_200.R')
source('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200_waterfall/v3_half_val_point_after_smooth_MI/FJ4.5_diag_200_waterFall_v3.R')
source('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200_waterfall/v3_half_val_point_after_smooth_MI_for147/FJ4.5_diag_147_waterFall_v3.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.5c5Nu_Free_cmp_maxBias/147bpCmp_TFMI/Nu_Free_cmp_all_data.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.5c5Nu_Free_cmp_maxBias/147bpCmp_noTF_diss_TFMI/Nu_Free_cmp_all_data.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/T_2modes_bound_vs_unbound.R')
source('~/Nut_zhuData/Analysis/Analysis2/1702_MI_diag_classify/FJ4.5_new_data200_waterfall/v3_half_val_point_after_smooth_MI/FJ4.5_diag_200_waterFall_v3.R')
outPath=paste0(fjComm::get_scriptpath(),"/cases/")
dir.create(outPath)
# plot extreme cases
for (type in c("top","end"))
{
for (rank in 1:20)
{
if (type=="top") TF= plotdf[rank,]$TF
if (type=="end") TF= plotdf[nrow(plotdf)-rank+1,]$TF
sig_diag= maxBias_diag_Mat[,TF]*1000
p= ggplot()+geom_line(aes(pos,sig_diag))+gg_theme_Publication()+ xlab("position (bp)") + ylab(expression("TEK-MI (x10"^"-3"*" bit)")) #+ylim(c(0,4))
gg_save_all(p,newName = paste0(type,"_",TF),path = outPath,height = 3.35,width = 4.2)
}
}
outPath=paste0(fjComm::get_scriptpath(),"/cases/")
dir.create(outPath)
# plot extreme cases
for (type in c("top","end"))
{
for (rank in 1:20)
{
if (type=="top") TF= plotdf[rank,]$TF
if (type=="end") TF= plotdf[nrow(plotdf)-rank+1,]$TF
sig_diag= maxBias_diag_Mat[,TF]*1000
p= ggplot()+geom_line(aes(pos,sig_diag))+gg_theme_Publication()+ xlab("position (bp)") + ylab(expression("TEK-MI (x10"^"-3"*" bit)")) #+ylim(c(0,4))
gg_save_all(p,newName = paste0(type,"_",TF),path = outPath,height = 3.4,width = 4.2)
}
}
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.5c5Nu_Free_cmp_maxBias/xyplot/Nu_xyplot_TF_signal_free_vs_bound.R')
source('~/Nut_zhuData/Analysis/Analysis2/Nusel/FJ4.5c5Nu_Free_cmp_maxBias/xyplot/Nu_xyplot_TF_signal_free_vs_bound.R')
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,color=family),size=0.6) +stat_function(fun = function(x){x},color="grey",size=1/2.5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,color=family),size=0.6) +stat_function(fun = function(x){x},color="grey",size=1/2.5,alpha=0.1) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,color=family),size=0.6) +stat_function(fun = function(x){x},color="grey",size=1/25,alpha=0.1) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,color=family),size=0.6) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
TFsignal_free_vs_bound= ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,color=family),size=0.6) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
gg_save_all(TFsignal_free_vs_bound,width = 6,height = 6)
TFsignal_free_vs_bound_no_color= ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
gg_save_all(TFsignal_free_vs_bound_no_color,width = 6,height = 6)
View(df)
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,color=ifelse(stringr::str_detect(TF,"TBX2($|o)"),"red","black")),size=0.6) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F)
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6,color=ifelse(stringr::str_detect(TF,"TBX2($|o)"),"red","black")) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=df$TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6,color=ifelse(stringr::str_detect(TF,"TBX2($|o)"),"red","black")) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
df$TF
ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=df$TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6,color=ifelse(stringr::str_detect(df$TF,"TBX2($|o)"),"red","black")) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
TFsignal_free_vs_bound_no_color= ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6,alpha=0.6,color=ifelse(stringr::str_detect(df$TF,"TBX2($|o)"),"red","black")) +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
gg_save_all(TFsignal_free_vs_bound_no_color,width = 6,height = 6)
TFsignal_free_vs_bound_no_color
df %>% dplyr::filter(str_detect(TF,"TBX2($|o)"))
TFsignal_free_vs_bound_no_color= ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6)+ geom_point(data =df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")),aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6,color="red") +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
gg_save_all(TFsignal_free_vs_bound_no_color,width = 6,height = 6)
ggplot()+geom_point(data =df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")),aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6,color="red")
ggplot()+geom_point(data =df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")),aes(x=freeSig*1000,y=NuSig*1000),size=0.6,color="red")
df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")
)
df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")) %>% .$freeSig
df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")) %>% as.data.frame() %>%  .$freeSig
ggplot()+geom_point(data =df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")),aes(x=unlist(freeSig)*1000,y=unlist(NuSig)*1000),size=0.6,color="red")
TFsignal_free_vs_bound_no_color= ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6)+ geom_point(data =df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")),aes(x=unlist(freeSig)*1000,y=unlist(NuSig)*1000),size=0.6,color="red") +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
gg_save_all(TFsignal_free_vs_bound_no_color,width = 6,height = 6)
TFsignal_free_vs_bound_no_color= ggplot(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000,TF=TF)) + geom_point(data = df,aes(x=unlist(df$freeSig)*1000,y=unlist(df$NuSig)*1000),size=0.6)+ geom_point(data =df %>% dplyr::filter(str_detect(TF,"TBX2($|o)")),aes(x=unlist(freeSig)*1000,y=unlist(NuSig)*1000),size=1,color="red") +stat_function(fun = function(x){x},color="grey",size=1/5) + coord_fixed(ratio = 1)+ theme_classic() + #scale_x_continuous(expand = c(0,0))+ scale_y_continuous(expand = c(0,0)) +
guides(color=F) + xlab(expression("TEK-MI of unbound (x10"^"-3"*" bit)")) + ylab (expression("TEK-MI of bound (x10"^"-3"*" bit)")) + gg_theme_Publication()
gg_save_all(TFsignal_free_vs_bound_no_color,width = 6,height = 6)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_DHS_pred_DHS_genome_prec_rec_2.R')
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_DHS_pred_DHS_genome_prec_rec_2.R')
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_DHS_pred_DHS_genome_prec_rec_2_debug.R')
traceback()
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_DHS_pred_DHS_genome_prec_rec_2_debug.R')
targetChrs
topkmers
binsize
DHS_cutoff_ratio
targetChrs
paste0("pred_top_dhs",DHStopPer,"_ati_",ATItopPer,"_binsize_",bestParam["binSize"],"_",basename(kmerTabFilei),"__")
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_DHS_pred_DHS_genome_prec_rec_2_debug.R')
binsize
bestParam
optMat[which(optMat$AUC==max(optMat$AUC)),]
optMat[which(optMat$AUC==max(optMat$AUC)),][1,]
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_DHS_pred_DHS_genome_prec_rec_2_debug.R')
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_DHS_pred_DHS_genome_prec_rec_2_ATIweight.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/symBreak/RFX5.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/symBreak/SOX.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/symBreak/SOX.R')
script_path_from_fun
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/symBreak/SOX.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/symBreak/SOX.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB1/CREB1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB1/CREB1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB1/CREB1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB1/CREB1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L1/CREB3L1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L1/CREB3L1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB1/CREB1.R')
file="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147v1IIIFJ4-4-TFctrl-J21-TF251-CREB1IIIc3_S237_L004_R1_001.peared_trimmed.fq_u.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5,filename = "CREB1_TFctrl_motif_map")
print(motif_map)
pdf(paste0("CREB1_TFctrl_","_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
# file="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147v1IIIFJ4-4-TFctrl-J21-TF251-CREB1IIIc3_S237_L004_R1_001.peared_trimmed.fq_u.gz"
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig200v1IIIFJ4-5-CAP2r-200c4-J21-CREB1IIIc4-AGAATGAC_S1389_L006_R1_001.peared_trimmed.fq.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5,filename = "CREB1_TFctrl_motif_map")
print(motif_map)
pdf(paste0("CREB1_TFctrl_","_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
# file="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147v1IIIFJ4-4-TFctrl-J21-TF251-CREB1IIIc3_S237_L004_R1_001.peared_trimmed.fq_u.gz"
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig200v1IIIFJ4-5-CAP2r-TFctrl200c4-J21-CREB1IIIc4-AGAATGAC_S2157_L008_R1_001.peared_trimmed.fq.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5,filename = "CREB1_TFctrl_motif_map")
print(motif_map)
pdf(paste0("CREB1_TFctrl_","_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB1/CREB1.R')
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-TFctrl147c4-J21-CREB1IIIc4-AGAATGAC_S1773_L007_R1_001.peared_trimmed.fq.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5,filename = "CREB1_TFctrl_motif_map")
print(motif_map)
pdf(paste0("CREB1_TFctrl_","_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
file="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147v1IIIFJ4-4-TFctrl-J21-TF251-CREB1IIIc3_S237_L004_R1_001.peared_trimmed.fq_u.gz"
# file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig200v1IIIFJ4-5-CAP2r-TFctrl200c4-J21-CREB1IIIc4-AGAATGAC_S2157_L008_R1_001.peared_trimmed.fq.gz"
# file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-TFctrl147c4-J21-CREB1IIIc4-AGAATGAC_S1773_L007_R1_001.peared_trimmed.fq.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5,filename = "CREB1_TFctrl_motif_map")
print(motif_map)
pdf(paste0("CREB1_TFctrl_","_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB1/CREB1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L1/CREB3L1.R')
motif_idx_to_use=1
TFname= "CREB3L1"
# file="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_200/Trulig200v1IIIFJ4-4-CAP2-C04-TF110-CREB3L1IIIc4_S436_L002_R1_001.peared_trimmed.fq_u.gz"
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig200v1IIIFJ4-5-CAP2r-200c4-C4-CREB3L1IIIc4-TTCTTCCC_S1204_L006_R1_001.peared_trimmed.fq.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
# pfmfile="CREB3L1_motif.txt"
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5)
print(motif_map)
pdf(paste0(TFname,"_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L1/CREB3L1.R')
# file="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147v1IIIFJ4-4-TFctrl-A24-TF108-CREB3L4IIIc3_S24_L004_R1_001.peared_trimmed.fq_u.gz"
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig200v1IIIFJ4-5-CAP2r-TFctrl200c4-A24-CREB3L4IIIc4-GAAACGTG_S1944_L008_R1_001.peared_trimmed.fq.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
pfmfile="CREB3L4_motif.txt"
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5,filename = "CREB3L4_TFctrl_motif_map")
print(motif_map)
pdf(paste0("CREB3L4_TFctrl_","_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L4/CREB3L4.R')
# file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-147c4-C4-CREB3L1IIIc4-TTCTTCCC_S52_L003_R1_001.peared_trimmed.fq.gz"
file="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_200/Trulig200v1IIIFJ4-4-CAP2-A24-TF108-CREB3L4IIIc4_S408_L002_R1_001.peared_trimmed.fq_u.gz"
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig200v1IIIFJ4-5-CAP2r-200c4-A24-CREB3L4IIIc4-GAAACGTG_S1176_L006_R1_001.peared_trimmed.fq.gz"
all_pfmfile= motif_getpfm_from_TFname(TFname)
pfmfile=all_pfmfile[motif_idx_to_use,]$file
pfmfile="CREB3L4_motif.txt"
pfm_title=all_pfmfile[motif_idx_to_use,]$pfmName
motif_map=fjComm::motif_plot_moods_singlePWM_hit(readsfile = file,pfmfile = pfmfile,dup_rm = T,combine_2strand_hits = F)
gg_save_pdf(motif_map,width = 4,height = 1.5)
print(motif_map)
pdf(paste0(TFname,"_motif.pdf"),height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T,title = pfm_title)
dev.off()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/support/CREB3L1/CREB3L1.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/motif_plot_ELF2_v2.R')
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig6_symbreak/motif_plot_ELF2_v2.R', echo=TRUE)
