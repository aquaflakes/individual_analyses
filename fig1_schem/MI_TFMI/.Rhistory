p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.9,y=0.9)
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.8,y=0.9)
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.6,y=0.95)
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.6,y=0.95,col = "blue")
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.6,y=0.9,col = "blue")
print(p)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.6,y=0.95,col = "blue")
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.6,y=0.95,col = "blue")
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac),x = 0.8,y=0.95,col = "blue")
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac %>% prettyNum(digit=2)),x = 0.8,y=0.95,col = "blue")
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
# isUnPaired_color= ifelse(isUnPaired=="unPaired", "red","white")
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac %>% prettyNum(digit=2)),x = 0.8,y=0.95,col = "blue",fontsize = 12)
print(p)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
# fix layout
set.seed(23)
enet=network(edgelist,matrix.type="edgelist",ignore.eval=FALSE)
verticesNames= network.vertex.names(enet)
TFs= verticesNames %>% str_split("_") %>% lapply(function(x)x[3]) %>% unlist() %>% str_replace("ooo.*","")
guide="~/Nut_zhuData/SELEXphp/guide/FJ4.5CAP2r_lig147_Fangj201703.txt" %>% read_tsv()
families= guide[match(TFs,guide$TF %>% str_replace("ooo.*","")),]$family
# check if exist same TF connection
NuVerts= verticesNames[grepl("Nu_",verticesNames)]
corrTFVerts= verticesNames[grepl("Nu_",verticesNames)] %>% str_replace("Nu_","TF_")
unPairedTFs= NuVerts[with(edgelist, !paste0(NuVerts,corrTFVerts) %in% c(paste0(TF1,TF2),paste0(TF2,TF1)))] %>% c(., str_replace(.,"Nu_","TF_"))
pairedFrac= 1-length(unPairedTFs)/length(verticesNames)
enet %v% "type"= str_sub(verticesNames,1,2) # Nu or TFctrl
enet %v% "families"= families
isUnPaired= ifelse(verticesNames %in% unPairedTFs, "unPaired", "paired" )
enet %v% "unPaired"= isUnPaired
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac %>% prettyNum(digit=2)),x = 0.8,y=0.95,col = "blue",fontsize = 12)
print(p)
# fix layout
set.seed(23)
enet=network(edgelist,matrix.type="edgelist",ignore.eval=FALSE)
verticesNames= network.vertex.names(enet)
TFs= verticesNames %>% str_split("_") %>% lapply(function(x)x[3]) %>% unlist() %>% str_replace("ooo.*","")
guide="~/Nut_zhuData/SELEXphp/guide/FJ4.5CAP2r_lig147_Fangj201703.txt" %>% read_tsv()
families= guide[match(TFs,guide$TF %>% str_replace("ooo.*","")),]$family
# check if exist same TF connection
NuVerts= verticesNames[grepl("Nu_",verticesNames)]
corrTFVerts= verticesNames[grepl("Nu_",verticesNames)] %>% str_replace("Nu_","TF_")
unPairedTFs= NuVerts[with(edgelist, !paste0(NuVerts,corrTFVerts) %in% c(paste0(TF1,TF2),paste0(TF2,TF1)))] %>% c(., str_replace(.,"Nu_","TF_"))
pairedFrac= 1-length(unPairedTFs)/length(verticesNames)
enet %v% "type"= str_sub(verticesNames,1,2) # Nu or TFctrl
enet %v% "families"= families
isUnPaired= ifelse(verticesNames %in% unPairedTFs, "unPaired", "paired" )
enet %v% "unPaired"= isUnPaired
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("frac of paired TFs: ",pairedFrac %>% prettyNum(digit=2)),x = 0.8,y=0.95,col = "blue",fontsize = 12)
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = T,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) + gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("●　unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(p)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
geom_nodelabel(aes(color = families, label = vertex.names))+
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("●  unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
geom_nodelabel(aes(color = families, label = verticesNames))+
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("●  unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
geom_nodetext(aes(color = families, label = verticesNames))+
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("●  unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(p)
library(GGally)
p=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
p=p+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
geom_nodetext(aes (label = verticesNames), size=2)+
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("●  unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(p)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
gg_save_plotly
gg_save_all(netPlot,20,18,newName = "plot/netPlot")
gg_save_plotly(netPlot,path = "plot/netPlot")
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
gg_save_plotly(netPlot,path = "plot/netPlot.html")
gg_save_plotly(netPlot,path = "plot/netPlot")
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
str_sub(verticesNames,1,2) %>% rename(Nu_CAP_SELEX=Nu)
str_sub(verticesNames,1,2) %>% str_replace_all(c("Nu","TF"),c("CAP-SELEX","TFctrl"))
?str_replace_all
str_sub(verticesNames,1,2) %>% str_replace_all(c("Nu"="CAP-SELEX","TF"="TFctrl"))
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha, TF=verticesNames) +
geom_nodetext(aes(label = verticesNames),size=2)+
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("●  unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(netPlot)
gg_save_all(netPlot,20,18,newName = "plot/netPlot")
# gg_save_plotly(netPlot,path = "plot/netPlot")
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha, TF=verticesNames) +
geom_nodetext(aes(label = verticesNames),size=2)+
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(netPlot)
gg_save_all(netPlot,20,18,newName = "plot/netPlot")
# gg_save_plotly(netPlot,path = "plot/netPlot")
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha, TF=verticesNames) +
geom_nodetext(aes(label = verticesNames),size=2)+
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("● unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(netPlot)
gg_save_all(netPlot,20,18,newName = "plot/netPlot")
# gg_save_plotly(netPlot,path = "plot/netPlot")
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.8,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("⦁ unpaired TFs",x = 0.8,y=0.9,col = "red",fontsize = 12)
print(netPlot)
gg_save_all(netPlot,20,18,newName = "plot/netPlot")
gg_save_all(netPlot+geom_nodetext(aes(label = verticesNames),size=2),20,18, newName = "plot/netPlot_withName")
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.75,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("circle: unpaired TFs",x = 0.75,y=0.9,col = "red",fontsize = 12)+
gg_anno_grob(paste0("pearson corr cutoff: ",cutoff),x = 0.75,y=0.97)
print(netPlot)
gg_save_all(netPlot,22,18,newName = "plot/netPlot")
gg_save_all(netPlot+geom_nodetext(aes(label = verticesNames),size=2),22,18, newName = "plot/netPlot_withName")
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.75,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("circle: unpaired TFs",x = 0.75,y=0.9,col = "red",fontsize = 12)+
gg_anno_grob(paste0("pearson corr cutoff: ",cutoff),x = 0.75,y=0.99)
print(netPlot)
gg_save_all(netPlot,22,18,newName = "plot/netPlot")
gg_save_all(netPlot+geom_nodetext(aes(label = verticesNames),size=2),22,18, newName = "plot/netPlot_withName")
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.75,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("circle: unpaired TFs",x = 0.75,y=0.9,col = "red",fontsize = 12)+
gg_anno_grob(paste0("pearson corr cutoff: ",cutoff),x = 0.75,y=0.99)
print(netPlot)
gg_save_all(netPlot,22,18,newName = "plot/netPlot")
gg_save_all(netPlot+geom_nodetext(aes(label = verticesNames),size=2),22,18, newName = "plot/netPlot_withName")
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
traceback()
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
TFfiles
paste0(TFfiles,well,"-*")
paste0(TFfiles,well,"-*") %>% Sys.glob()
paste0(TFfiles) %>% Sys.glob()
paste0(TFfiles,"*") %>% Sys.glob()
paste0(TFfiles,well,"-*") %>% Sys.glob()
paste0(TFfiles,well,"-*")
paste0("~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147",well,"-*")
paste0("~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/*-",well,"-*")
paste0("~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/*-",well,"-*") %>% Sys.glob()
allwells
well
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
well
well %>% sub("(\\w)(\\d)","\\10\\2")
well %>% str_replace("(\\w)(\\d)","\\10\\2")
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
Sys.glob(paste0(TFfiles,well_alt,"-*") )
Sys.glob(paste0(TFfiles,well_alt,"-*") )|| Sys.glob(paste0(TFfiles,well_alt,"-*") )
Sys.glob(paste0(TFfiles,well_alt,"-*") ) '|| Sys.glob(paste0(TFfiles,well_alt,"-*") )
c(Sys.glob(paste0(TFfiles,well_alt,"-*") ),  Sys.glob(paste0(TFfiles,well_alt,"-*") ))
c(Sys.glob(paste0(TFfiles,well,"-*") ),  Sys.glob(paste0(TFfiles,well_alt,"-*") ))
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
options(error = recover)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
test
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
View(kktable)
kktable %>% arrange(desc(TFcounts)) %>% head(topRows)
kktable %>% arrange(desc(TFcounts)) %>% head
topRows
TFfiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147*-"
Nufiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_147/Trulig147*-"
outDir="~/Nut_zhuData/Analysis/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/2_FJ4.4_2gap"
kmerLen=3L; gapped=T
gapNo = 2; gapMins = c(0,0); gapMaxs = c(5,5)
test=T
library(fjComm)
# kmerLen=9L; gapped=T
topPercent=0.001
topRows= (4^kmerLen*topPercent) %>% as.integer()
if (gapped) topRows= (4^kmerLen*(gapNo+1)*topPercent) %>% as.integer()
topRows
(4^kmerLen*(gapNo+1)*topPercent)
TFfiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147*-"
Nufiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_147/Trulig147*-"
outDir="~/Nut_zhuData/Analysis/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/2_FJ4.4_2gap"
kmerLen=3L; gapped=T
gapNo = 2; gapMins = c(0,0); gapMaxs = c(5,5)
test=T
library(fjComm)
# kmerLen=9L; gapped=T
topPercent=0.001
topRows= (4^kmerLen*topPercent) %>% as.integer()
if (gapped) topRows= (4^(kmerLen*(gapNo+1))*topPercent) %>% as.integer()
topPercent
topRows
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
options(error = NULL)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
topkmers
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
names(rankVect)=x_selex$kmerCntGap$kmer
rankVect %>% sort() %>% head(topKmersEach)
Q
Q
Q
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
kktable %>% head
kktable %>% tail()
?top_n
?tally
kktable %>% tally(ycounts)
kktable %>% count(ycounts)
kktable %>% top_n(-10,dense_rank(ycounts)+dense_rank(xcounts))
kktable %>% top_n(-10,rank(ycounts)+rank(xcounts))
kktable %>% top_n(10,ycounts)
kktable %>% top_n(1,ycounts)
kktable %>% top_n(-1,ycounts)
library(fjComm)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
topkmers
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(-1, cmbRank)
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(-1, cmbRank)
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(1, cmbRank)
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(2, cmbRank)
rank(0,4,2)
rank(c(0,4,2))
kktable %>% top_n(-1, rank(ycounts)+rank(xcounts))
kktable %>% top_n(1, rank(ycounts)+rank(xcounts))
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
p=xyplot("~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-147c4-A1-BARHL1oooNIIIc4-CCCGCGCT_S1_L003_R1_001.peared_trimmed.fq.gz",
"~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-147c4-A10-VSX1IIIc4-GCTCCGAT_S10_L003_R1_001.peared_trimmed.fq.gz",
test = F,kmerLen = 4L,gapped = T,gapNo = 1,gapMins = 0,gapMaxs = 2)
print(p)
library(fjComm)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
unlink("/Library/Frameworks/R.framework/Versions/3.3/Resources/library/00LOCK-fjComm",force = T)
unlink("/Library/Frameworks/R.framework/Versions/3.3/Resources/library/00LOCK-fjComm",force = T,recursive = T)
library(fjComm)
library(fjComm)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binMat
binMat[,nrow(binMat)]
binMat[,ncol(binMat)]
is.na(binMat) %>% head
any(is.na(binMat) )
binMat %>% count()
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
table(binMat)
binMat[nrow(binMat),]
binMat[nrow(binMat)-1,]
binMat[ncol(binMat)-1,]
binMat[,ncol(binMat)]
binMat[,ncol(binMat)-1]
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
scoreCurrChr %>% length()
matrix(scoreCurrChr, nrow = binsize) %>% length()
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
ncol(scoreMat)
scoreCurrChr
scoreCurrChr %>% length()
scoreCurrChr= getChrScore(topKmers=ktab$kmer,chrSeq=currSeq)
scoreCurrChr=c( rep(0,floor((kmerLen-1)/2)),scoreCurrChr,rep(0,ceiling((kmerLen-1)/2)) )
length(scoreCurrChr)
DHSLabel %>% length()
matrix(1:100, nrow = 10)
1:binzi
1:binsize
seq(1,10)
binsize*1:nrow(DHSLabel)
binsize*1:nrow(binMat)
binsize*1:nrow(binMat) %>% head
binsize*0:(nrow(binMat)-1) %>% head
binsize*0:(nrow(binMat)-1) %>% head+1
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% head()
binStarts=binsize*0:(nrow(binMat)-1)+1
binStarts=binsize*0:(nrow(binMat)-1)+1
binStarts %>% head()
binEnds %>% head
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% head()
binEnds %>% head()
binsize
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% length()
scoreCurrChr %>% length()
binEnds %>% length()
binStarts %>% tail()
binEnds %>% tail()
allchr
rep(1,)
rep(1,3)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
print(p)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred
pred$allchrs
pred$allchrs %>% count
pred$allchrs %>% table
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred$allchrs %>% table
regions= data.frame(chr=pred$allchrs, start=pred$allbinStarts, end=pred$allbinEnds)
View(regions)
regions
read_tsv("~/Downloads/mart_export.txt") %>% head
read_tsv("~/Downloads/mart_export.txt") %>% tail
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig1_schem/MI_TFMI/MI_TFMI.R', echo=TRUE)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig1_schem/MI_TFMI/MI_TFMI.R', echo=TRUE)
print(SOX11_motif_map)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig1_schem/MI_TFMI/MI_TFMI.R', echo=TRUE)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig1_schem/MI_TFMI/MI_TFMI.R', echo=TRUE)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig1_schem/MI_TFMI/MI_TFMI.R', echo=TRUE)
pfmfile="~/Nut_zhuData/SELEXphp/data/pfm/shortspacek/*_AR_GAACAATG*"
pfmfile= Sys.glob(pfmfile)
pfmfile
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig1_schem/MI_TFMI/MI_TFMI.R', echo=TRUE)
T)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T)
pfmfile="SOX.pfm.txt"
pfmfile="~/Nut_zhuData/SELEXphp/data/pfm/shortspacek/*_AR_GAACAATG*"
pfmfile= Sys.glob(pfmfile)[4]
SOX11_motif_map=fjComm::moods_single_pwm_match(readsfile = file,pfmfile = pfmfile,dup_rm = F,combine_2strand_hits = T)
gg_save_pdf(SOX11_motif_map,width = 4,height = 1.5)
print(SOX11_motif_map)
pdf("SOX11_motif.pdf",height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T)
dev.off()
pfmfile= Sys.glob(pfmfile)[1]
SOX11_motif_map=fjComm::moods_single_pwm_match(readsfile = file,pfmfile = pfmfile,dup_rm = F,combine_2strand_hits = T)
gg_save_pdf(SOX11_motif_map,width = 4,height = 1.5)
print(SOX11_motif_map)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T)
pfmfile="SOX.pfm.txt"
pfmfile="~/Nut_zhuData/SELEXphp/data/pfm/shortspacek/*_AR_GAACAATG*"
pfmfile= Sys.glob(pfmfile)[1]
SOX11_motif_map=fjComm::moods_single_pwm_match(readsfile = file,pfmfile = pfmfile,dup_rm = F,combine_2strand_hits = T)
gg_save_pdf(SOX11_motif_map,width = 4,height = 1.5)
print(SOX11_motif_map)
pdf("SOX11_motif.pdf",height = 3)
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T)
dev.off()
fjComm::plotMotif_pfmFile(pfmfile,ic.scale = T)
