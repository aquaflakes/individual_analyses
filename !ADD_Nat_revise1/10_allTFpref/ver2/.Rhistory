netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.75,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("circle: unpaired TFs",x = 0.75,y=0.9,col = "red",fontsize = 12)+
gg_anno_grob(paste0("pearson corr cutoff: ",cutoff),x = 0.75,y=0.99)
print(netPlot)
gg_save_all(netPlot,22,18,newName = "plot/netPlot")
gg_save_all(netPlot+geom_nodetext(aes(label = verticesNames),size=2),22,18, newName = "plot/netPlot_withName")
library(GGally)
netPlot=ggnet2(enet, shape = "type", color = "families", label = F,size = 4,label.size = 2, node.alpha = 0.4,
edge.color = "sameTF", edge.size = "corr",edge.alpha = 0.5) +
scale_color_discrete() + guides(color=F)
isUnPaired_alpha= ifelse(isUnPaired=="unPaired", 1,0)
netPlot=netPlot+ geom_nodes(color="red", alpha=isUnPaired_alpha) +
gg_anno_grob(paste0("---  TF pairs (",pairedFrac %>% prettyNum(digit=2),")\n"),x = 0.75,y=0.95,col = "blue",fontsize = 12)+
gg_anno_grob("circle: unpaired TFs",x = 0.75,y=0.9,col = "red",fontsize = 12)+
gg_anno_grob(paste0("pearson corr cutoff: ",cutoff),x = 0.75,y=0.99)
print(netPlot)
gg_save_all(netPlot,22,18,newName = "plot/netPlot")
gg_save_all(netPlot+geom_nodetext(aes(label = verticesNames),size=2),22,18, newName = "plot/netPlot_withName")
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/motif_similarity_top_kmers_allTFNetwork.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
traceback()
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
TFfiles
paste0(TFfiles,well,"-*")
paste0(TFfiles,well,"-*") %>% Sys.glob()
paste0(TFfiles) %>% Sys.glob()
paste0(TFfiles,"*") %>% Sys.glob()
paste0(TFfiles,well,"-*") %>% Sys.glob()
paste0(TFfiles,well,"-*")
paste0("~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147",well,"-*")
paste0("~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/*-",well,"-*")
paste0("~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/*-",well,"-*") %>% Sys.glob()
allwells
well
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
well
well %>% sub("(\\w)(\\d)","\\10\\2")
well %>% str_replace("(\\w)(\\d)","\\10\\2")
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
Sys.glob(paste0(TFfiles,well_alt,"-*") )
Sys.glob(paste0(TFfiles,well_alt,"-*") )|| Sys.glob(paste0(TFfiles,well_alt,"-*") )
Sys.glob(paste0(TFfiles,well_alt,"-*") ) '|| Sys.glob(paste0(TFfiles,well_alt,"-*") )
c(Sys.glob(paste0(TFfiles,well_alt,"-*") ),  Sys.glob(paste0(TFfiles,well_alt,"-*") ))
c(Sys.glob(paste0(TFfiles,well,"-*") ),  Sys.glob(paste0(TFfiles,well_alt,"-*") ))
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
options(error = recover)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
test
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
debugSource('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
View(kktable)
kktable %>% arrange(desc(TFcounts)) %>% head(topRows)
kktable %>% arrange(desc(TFcounts)) %>% head
topRows
TFfiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147*-"
Nufiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_147/Trulig147*-"
outDir="~/Nut_zhuData/Analysis/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/2_FJ4.4_2gap"
kmerLen=3L; gapped=T
gapNo = 2; gapMins = c(0,0); gapMaxs = c(5,5)
test=T
library(fjComm)
# kmerLen=9L; gapped=T
topPercent=0.001
topRows= (4^kmerLen*topPercent) %>% as.integer()
if (gapped) topRows= (4^kmerLen*(gapNo+1)*topPercent) %>% as.integer()
topRows
(4^kmerLen*(gapNo+1)*topPercent)
TFfiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_TFctrl/Trulig147*-"
Nufiles="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/allreads/rmdup_147/Trulig147*-"
outDir="~/Nut_zhuData/Analysis/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/2_FJ4.4_2gap"
kmerLen=3L; gapped=T
gapNo = 2; gapMins = c(0,0); gapMaxs = c(5,5)
test=T
library(fjComm)
# kmerLen=9L; gapped=T
topPercent=0.001
topRows= (4^kmerLen*topPercent) %>% as.integer()
if (gapped) topRows= (4^(kmerLen*(gapNo+1))*topPercent) %>% as.integer()
topPercent
topRows
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
options(error = NULL)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
topkmers
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
names(rankVect)=x_selex$kmerCntGap$kmer
rankVect %>% sort() %>% head(topKmersEach)
Q
Q
Q
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
kktable %>% head
kktable %>% tail()
?top_n
?tally
kktable %>% tally(ycounts)
kktable %>% count(ycounts)
kktable %>% top_n(-10,dense_rank(ycounts)+dense_rank(xcounts))
kktable %>% top_n(-10,rank(ycounts)+rank(xcounts))
kktable %>% top_n(10,ycounts)
kktable %>% top_n(1,ycounts)
kktable %>% top_n(-1,ycounts)
library(fjComm)
debugSource('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
topkmers
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(-1, cmbRank)
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(-1, cmbRank)
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(1, cmbRank)
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(2, cmbRank)
rank(0,4,2)
rank(c(0,4,2))
kktable %>% top_n(-1, rank(ycounts)+rank(xcounts))
kktable %>% top_n(1, rank(ycounts)+rank(xcounts))
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
p=xyplot("~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-147c4-A1-BARHL1oooNIIIc4-CCCGCGCT_S1_L003_R1_001.peared_trimmed.fq.gz",
"~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-147c4-A10-VSX1IIIc4-GCTCCGAT_S10_L003_R1_001.peared_trimmed.fq.gz",
test = F,kmerLen = 4L,gapped = T,gapNo = 1,gapMins = 0,gapMaxs = 2)
print(p)
library(fjComm)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
unlink("/Library/Frameworks/R.framework/Versions/3.3/Resources/library/00LOCK-fjComm",force = T)
unlink("/Library/Frameworks/R.framework/Versions/3.3/Resources/library/00LOCK-fjComm",force = T,recursive = T)
library(fjComm)
library(fjComm)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binMat
binMat[,nrow(binMat)]
binMat[,ncol(binMat)]
is.na(binMat) %>% head
any(is.na(binMat) )
binMat %>% count()
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
table(binMat)
binMat[nrow(binMat),]
binMat[nrow(binMat)-1,]
binMat[ncol(binMat)-1,]
binMat[,ncol(binMat)]
binMat[,ncol(binMat)-1]
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
scoreCurrChr %>% length()
matrix(scoreCurrChr, nrow = binsize) %>% length()
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
ncol(scoreMat)
scoreCurrChr
scoreCurrChr %>% length()
scoreCurrChr= getChrScore(topKmers=ktab$kmer,chrSeq=currSeq)
scoreCurrChr=c( rep(0,floor((kmerLen-1)/2)),scoreCurrChr,rep(0,ceiling((kmerLen-1)/2)) )
length(scoreCurrChr)
DHSLabel %>% length()
matrix(1:100, nrow = 10)
1:binzi
1:binsize
seq(1,10)
binsize*1:nrow(DHSLabel)
binsize*1:nrow(binMat)
binsize*1:nrow(binMat) %>% head
binsize*0:(nrow(binMat)-1) %>% head
binsize*0:(nrow(binMat)-1) %>% head+1
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% head()
binStarts=binsize*0:(nrow(binMat)-1)+1
binStarts=binsize*0:(nrow(binMat)-1)+1
binStarts %>% head()
binEnds %>% head
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% head()
binEnds %>% head()
binsize
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% length()
scoreCurrChr %>% length()
binEnds %>% length()
binStarts %>% tail()
binEnds %>% tail()
allchr
rep(1,)
rep(1,3)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
print(p)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred
pred$allchrs
pred$allchrs %>% count
pred$allchrs %>% table
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred$allchrs %>% table
regions= data.frame(chr=pred$allchrs, start=pred$allbinStarts, end=pred$allbinEnds)
View(regions)
regions
read_tsv("~/Downloads/mart_export.txt") %>% head
read_tsv("~/Downloads/mart_export.txt") %>% tail
fft(c(1,1,1,1))
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/P24_Trulig147v1IIIFJ4-5-CAP2r-147c4-P24-SHOXIIIc4-GGTATGAA_S384_L003_R1_001.peared_trimmed.fq.gz_3mer_foldchn_maxBias.csv"
tfmi=rio::import(file)
View(tfmi)
fjComm::gg_heat2D_diag(tfmi)
tfmi %<>% dplyr::filter(pos2-pos1==3)
library(dplyr)
tfmi %<>% dplyr::filter(pos2-pos1==3)
library(magrittr)
tfmi %<>% dplyr::filter(pos2-pos1==3)
plot(0,0,type="n",main="distance_distribution",xlim=c(100,250),ylim=c(2.87297596251,9.06081360917),xlab="Distance",ylab="Percent",)
lines(c(100,110,120,130,140,150,160,170,180,190,200,210,220,230,240),c(5.4577263704,5.90807306192,5.84957266867,5.98559162931,6.24593253199,6.25670388726,6.08599167653,5.83557296687,5.58145160383,5.29335610108,4.78685760016,4.24289650923,3.7353499432,3.28804034546,2.87297596251),col="black")
lines(c(100,110,120,130,140,150,160,170,180,190,200,210,220,230,240),c(5.8583190651,6.42183883897,6.29681757886,6.20811892798,6.26494746778,6.05907097977,5.78061037105,5.52563420796,5.29365370852,5.09108413595,4.67213690049,4.1906408489,3.73037626359,3.29126677238,2.88935817048),col="gray")
lines(c(100,110,120,130,140,150,160,170,180,190,200,210,220,230,240),c(5.42649438362,7.11122092598,6.80900972806,6.60788002817,6.5855105628,6.53522813783,6.72572466176,6.26904267066,6.14955034861,5.77946974593,5.37782473845,4.6379637475,4.07521530261,3.42254216546,2.93939941476),col="red")
plot(0,0,type="n",main="fuzziness_distribution",xlim=c(31.3487378188,74.519457904),ylim=c(0.0309779394064,5.05113219782),xlab="Fuzziness",ylab="Percent",)
lines(c(31.0829184613,31.5146256622,31.946332863,32.3780400639,32.8097472648,33.2414544656,33.6731616665,34.1048688673,34.5365760682,34.968283269,35.3999904699,35.8316976707,36.2634048716,36.6951120724,37.1268192733,37.5585264741,37.990233675,38.4219408758,38.8536480767,39.2853552775,39.7170624784,40.1487696792,40.5804768801,41.0121840809,41.4438912818,41.8755984826,42.3073056835,42.7390128843,43.1707200852,43.6024272861,44.0341344869,44.4658416878,44.8975488886,45.3292560895,45.7609632903,46.1926704912,46.624377692,47.0560848929,47.4877920937,47.9194992946,48.3512064954,48.7829136963,49.2146208971,49.646328098,50.0780352988,50.5097424997,50.9414497005,51.3731569014,51.8048641022,52.2365713031,52.6682785039,53.0999857048,53.5316929056,53.9634001065,54.3951073074,54.8268145082,55.2585217091,55.6902289099,56.1219361108,56.5536433116,56.9853505125,57.4170577133,57.8487649142,58.280472115,58.7121793159,59.1438865167,59.5755937176,60.0073009184,60.4390081193,60.8707153201,61.302422521,61.7341297218,62.1658369227,62.5975441235,63.0292513244,63.4609585252,63.8926657261,64.3243729269,64.7560801278,65.1877873287,65.6194945295,66.0512017304,66.4829089312,66.9146161321,67.3463233329,67.7780305338,68.2097377346,68.6414449355,69.0731521363,69.5048593372,69.936566538,70.3682737389,70.7999809397,71.2316881406,71.6633953414,72.0951025423,72.5268097431,72.958516944,73.3902241448,73.8219313457),c(0.12800929519,0.286504279816,0.534911010475,0.206866631879,0.207509241142,3.46943976024,0.158127779333,0.447638552486,0.208128900074,0.314159428451,0.341500922565,0.51483712112,0.44971938248,0.376224773092,0.328778789182,0.462418565532,0.541734908838,0.734685990131,1.08333211569,0.684470666302,0.539019119691,0.854433166227,0.647765437215,0.81268651447,0.908580646736,1.00637965646,0.998920798944,1.09597774797,1.05382564037,1.24366312678,1.12357934583,1.27939679187,1.29368719785,1.68028552048,1.40742903739,1.65263802195,2.11074192529,1.57927346444,1.70799421988,1.73609307491,1.62844837327,1.8024348312,1.98032284536,1.8939607505,1.88738165566,2.27150899267,1.82139945456,1.77583539778,1.85618450597,1.79144162274,2.45110298142,1.85009501819,2.08382118724,1.88272273851,1.65519315878,1.47979908056,1.54545232692,1.53377060854,1.28223498278,1.20287273881,1.34197469389,1.13987408071,1.06652482342,1.0012693828,1.04207507099,1.04272533036,0.909712863056,0.849062788816,1.1195324375,0.894236689975,0.838826941271,0.98029278043,0.76975409562,0.694002703702,0.739559110375,0.703802494961,0.598827681802,0.675091631108,0.639159063158,0.691814772164,0.648989454858,0.601000313119,0.551236345796,0.530542797509,0.507118159855,0.522349529407,0.50109752307,0.479570112763,0.442949034889,0.445152266647,0.399289855564,0.401554288204,0.379506670399,0.34471396888,0.328694637969,0.304956345793,0.270308996369,0.24226369211,0.217041278542,0.186456137672),col="black")
lines(c(31.0829184613,31.5146256622,31.946332863,32.3780400639,32.8097472648,33.2414544656,33.6731616665,34.1048688673,34.5365760682,34.968283269,35.3999904699,35.8316976707,36.2634048716,36.6951120724,37.1268192733,37.5585264741,37.990233675,38.4219408758,38.8536480767,39.2853552775,39.7170624784,40.1487696792,40.5804768801,41.0121840809,41.4438912818,41.8755984826,42.3073056835,42.7390128843,43.1707200852,43.6024272861,44.0341344869,44.4658416878,44.8975488886,45.3292560895,45.7609632903,46.1926704912,46.624377692,47.0560848929,47.4877920937,47.9194992946,48.3512064954,48.7829136963,49.2146208971,49.646328098,50.0780352988,50.5097424997,50.9414497005,51.3731569014,51.8048641022,52.2365713031,52.6682785039,53.0999857048,53.5316929056,53.9634001065,54.3951073074,54.8268145082,55.2585217091,55.6902289099,56.1219361108,56.5536433116,56.9853505125,57.4170577133,57.8487649142,58.280472115,58.7121793159,59.1438865167,59.5755937176,60.0073009184,60.4390081193,60.8707153201,61.302422521,61.7341297218,62.1658369227,62.5975441235,63.0292513244,63.4609585252,63.8926657261,64.3243729269,64.7560801278,65.1877873287,65.6194945295,66.0512017304,66.4829089312,66.9146161321,67.3463233329,67.7780305338,68.2097377346,68.6414449355,69.0731521363,69.5048593372,69.936566538,70.3682737389,70.7999809397,71.2316881406,71.6633953414,72.0951025423,72.5268097431,72.958516944,73.3902241448,73.8219313457),c(0.0726146695838,0.188455993547,0.416633158372,0.134010265796,0.120759692413,3.40277015647,0.0881182223031,0.304007103224,0.131253230066,0.212123732403,0.225817264436,0.407277566214,0.319266264964,0.244956132965,0.205502264321,0.311919261163,0.385144908194,0.582192772091,0.869650023717,0.479013955718,0.371375003981,0.647445163438,0.472262654928,0.630689106952,0.680728159867,0.82525487497,0.780302209302,0.88302279259,0.855162221004,1.01377196626,0.932030821063,1.08855560578,1.12197607214,1.52218921162,1.27299442262,1.50301979422,1.9618791314,1.47436495195,1.62457375731,1.66864050568,1.58729649582,1.78719304207,1.9967124831,1.89732936412,1.95403570842,2.37350991193,1.93382762936,1.90527207093,2.01730242307,1.9748394905,2.70772984991,2.05902454548,2.36756815625,2.13676378841,1.91187826458,1.73597785757,1.78903361163,1.77016204573,1.51738540144,1.4395086886,1.53781495983,1.3556596712,1.25464982477,1.18806855747,1.20414490155,1.19862319287,1.06001532179,0.987919983033,1.26590708423,1.02302063737,0.971148652111,1.11608013977,0.861081065022,0.797455401128,0.837940294215,0.787282626635,0.686960129827,0.747973865134,0.714202086748,0.769755211122,0.711857460795,0.660772109002,0.607838550432,0.573577990087,0.54576324181,0.560251044523,0.535911230476,0.506233000985,0.468054547761,0.470544280858,0.411080900822,0.415548673404,0.382624626225,0.34692826888,0.327460999973,0.30366342841,0.265568984585,0.238601967515,0.209007747423,0.179360066804),col="gray")
lines(c(31.0829184613,31.5146256622,31.946332863,32.3780400639,32.8097472648,33.2414544656,33.6731616665,34.1048688673,34.5365760682,34.968283269,35.3999904699,35.8316976707,36.2634048716,36.6951120724,37.1268192733,37.5585264741,37.990233675,38.4219408758,38.8536480767,39.2853552775,39.7170624784,40.1487696792,40.5804768801,41.0121840809,41.4438912818,41.8755984826,42.3073056835,42.7390128843,43.1707200852,43.6024272861,44.0341344869,44.4658416878,44.8975488886,45.3292560895,45.7609632903,46.1926704912,46.624377692,47.0560848929,47.4877920937,47.9194992946,48.3512064954,48.7829136963,49.2146208971,49.646328098,50.0780352988,50.5097424997,50.9414497005,51.3731569014,51.8048641022,52.2365713031,52.6682785039,53.0999857048,53.5316929056,53.9634001065,54.3951073074,54.8268145082,55.2585217091,55.6902289099,56.1219361108,56.5536433116,56.9853505125,57.4170577133,57.8487649142,58.280472115,58.7121793159,59.1438865167,59.5755937176,60.0073009184,60.4390081193,60.8707153201,61.302422521,61.7341297218,62.1658369227,62.5975441235,63.0292513244,63.4609585252,63.8926657261,64.3243729269,64.7560801278,65.1877873287,65.6194945295,66.0512017304,66.4829089312,66.9146161321,67.3463233329,67.7780305338,68.2097377346,68.6414449355,69.0731521363,69.5048593372,69.936566538,70.3682737389,70.7999809397,71.2316881406,71.6633953414,72.0951025423,72.5268097431,72.958516944,73.3902241448,73.8219313457),c(0.0309779394064,0.0490466586274,0.0644274115038,0.0483275403586,0.053375331702,0.254679574863,0.0567125990079,0.0902249066822,0.077937060535,0.0947490682182,0.106310814366,0.124547095125,0.137246863388,0.143453622038,0.159630292222,0.191194697012,0.208292955657,0.237846621987,0.287284257538,0.291654820997,0.307489386373,0.358469984422,0.378277154604,0.430158395922,0.480447802626,0.519901563182,0.579504598726,0.633473377544,0.688398653475,0.767690169779,0.81221266687,0.902039614899,0.974719432167,1.07377622827,1.14119182054,1.23985065799,1.35837950119,1.41942077327,1.51440023861,1.61065037894,1.69686777216,1.81142401056,1.91062742301,2.00789689603,2.07845426715,2.18551212671,2.23347661707,2.29353346511,2.35274552373,2.4022320314,2.47003161886,2.44773895253,2.45189308233,2.42541835927,2.37392111314,2.30682668049,2.24822203244,2.15543483057,2.04323143544,1.94049526722,1.83894599324,1.72696601349,1.6181068674,1.52097702899,1.44128755403,1.36873340792,1.29783393199,1.24132380318,1.21229376665,1.15088246284,1.11419346767,1.08443733115,1.03372203887,0.993241963888,0.955624398524,0.921462789888,0.874615376452,0.853746983194,0.816248107253,0.789766402459,0.750207915942,0.718692383267,0.685005532323,0.659780539068,0.627378326585,0.601364397753,0.57534348719,0.548791965089,0.523783405487,0.502237784345,0.473089058399,0.454189513217,0.43114281996,0.407286245935,0.390348567098,0.369263740186,0.352479659426,0.328909336361,0.309870156564,0.294838490226),col="red")
legend("topright",legend=c("GP5dFixed","LoVo","LoVoFixed"),col=c("black","gray","red"),lty=1)
pacman::p_load(QuasR)
file.copy(system.file(package="QuasR", "extdata"), ".", recursive=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/test/map_to_genome.R')
head(auxFile)
head(auxFile %>% read_csv())
library(fjComm)
library(devtools)
pacman::p_load(DBI)
library(dplyr)
pacman::p_load(BSgenome.Mmusculus.UCSC.mm9,BSgenome.Mmusculus.UCSC.mm9.masked)
library(BSgenome.Mmusculus.UCSC.mm9.masked)
library(BSgenome.Mmusculus.UCSC.mm9)
pacman::p_load(BSgenome.Mmusculus.UCSC.mm9, BSgenome.Mmusculus.UCSC.mm9.masked)
chunkPE <- readGAlignmentPairs(bamFile,strandMode = T)
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/fromOthers/Eevi/LoVo_DNase/LoVo_DNase_rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignments(bamFile,strandMode = T)
close(bamFile)
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/fromOthers/Eevi/LoVo_DNase/LoVo_DNase_rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignments(bamFile)
close(bamFile)
chunkPE
?`readGAlignments,BamFile-method`
pacman::p_load(BSgenome)
pacman::p_load(BSgenome,BSgenome.Hsapiens.UCSC.hg19.masked)
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.tsv")
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
bedfile=read_tsv("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
View(bedfile)
?getSeq
bedfile
View(bedfile)
source('~/.active-rstudio-document')
pacman::p_load(BSgenome,BSgenome.Hsapiens.UCSC.hg19.masked,GenomicRanges)
source('~/.active-rstudio-document')
bedRanges
source('~/.active-rstudio-document')
black_sequences
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/seqFiles2/FJ7.1MNase/analysis/align/testout/FJ7-1-1-MNaseTest-B5-GP5dFixed-x4MNase-GCCGAATT_S1_L004.sorted.rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignments(bamFile,use.names = )
close(bamFile)
chunkPE
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/seqFiles2/FJ7.1MNase/analysis/align/testout/FJ7-1-1-MNaseTest-B5-GP5dFixed-x4MNase-GCCGAATT_S1_L004.sorted.rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignmentPairs(bamFile,use.names = )
close(bamFile)
chunkPE
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
pacman::p_load(tidyverse)
map(c(1,2,3),max)
is.factor(iris)
iris %>%
keep(is.factor)
iris %>%
keep(is.numeric())
iris %>%
keep(is.numeric)
dfs <- list(
age = tibble(name = "John", age = 30),
sex = tibble(name = c("John", "Mary"), sex = c("M", "F")),
trt = tibble(name = "Mary", treatment = "A")
)
dfs
c(1,2,3) %>% cumsum()
diamonds %>%
count(cut_width(carat, 0.5))
parse_logical("TRUESLJ")
parse_number("TR3UESLJ")
parse_number("TR3UESL4J")
guess_encoding(charToRaw(x2))
iris %>% count(Species)
x <- c("apple", "banana", "pear")
str_view(x, "an")
library(stringr)
x <- c("apple", "banana", "pear")
str_view(x, "an")
x <- c("apple", "banana", "pear")
str_view(x, "..a")
x <- c("apple", "banana", "pear")
str_view(c("ACTAC","TCAT"), "..a")
x <- c("apple", "banana", "pear")
str_view(c("ACTAC","TCAT"), "..A")
iris$Species %>% str_view("to")
iris$Species %>% as.character() %>%  str_view("to")
rep("N",30) %>% str_c()
rep("N",30) %>% str_c(collapse = "")
list(aa=list(bb=1,cc=1),dd=2)
list(aa=list(bb=1,cc=1),dd=2) %>% flatten_int()
list(aa=list(bb=1,cc=1),dd=2) %>% flatten
rnorm(100) %>%
matrix(ncol = 2)
rnorm(100) %>%
matrix(ncol = 2) %>% plot
rnorm(100) %>%
matrix(ncol = 2) %>% plot %>% str()
rnorm(100) %>%
matrix(ncol = 2) %T>% plot %>% str()
library(gapminder)
pacman::p_load()
pacman::p_load(gapminder)
by_country <- gapminder %>%
group_by(country, continent)
gapminder %>%
group_by(country, continent)
gapminder %>%
group_by(country, continent) %>% nest
by_country=gapminder %>%
group_by(country, continent) %>% nest
by_country$data
fjComm::calc_Vplot
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/10_allTFpref/untitled folder/allTFpref.R', echo=TRUE)
View(classify_df)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/10_allTFpref/untitled folder/allTFpref.R', echo=TRUE)
View(classify_df)
classify_df[,1:5]=apply(classify_df[,1:5],2,squishQuan_normalize)
View(classify_df)
classify_df[,6]
classify_df[,6] %>% range()
p=ggheat(classify_df %>% as.matrix(),clustering = "row",labRow = T)+scale_x_continuous(expand = c(0,0),limits = c(0.5,6.5),breaks = 1:6,labels = qw("E P D Gs Asym Ds"))+
scale_fill_gradientn(colours = c("green", "white", "red"),guide=F,values = c(-1,0,1))+theme(axis.text.y =element_text(size=4))
p
p=ggheat(classify_df %>% as.matrix(),clustering = "row",labRow = T)+scale_x_continuous(expand = c(0,0),limits = c(0.5,6.5),breaks = 1:6,labels = qw("E P D Gs Asym Ds"))+
scale_fill_gradientn(colours = c("green", "white", "red"),guide=T,values = c(-1,0,1))+theme(axis.text.y =element_text(size=4))
p=ggheat(classify_df %>% as.matrix(),clustering = "row",labRow = T)+scale_x_continuous(expand = c(0,0),limits = c(0.5,6.5),breaks = 1:6,labels = qw("E P D Gs Asym Ds"))+
scale_fill_gradientn(colours = c("green", "white", "red"),guide=T, limits= c(-1,0,1))+theme(axis.text.y =element_text(size=4))
p
p=ggheat(classify_df %>% as.matrix(),clustering = "row",labRow = T)+scale_x_continuous(expand = c(0,0),limits = c(0.5,6.5),breaks = 1:6,labels = qw("E P D Gs Asym Ds"))+
scale_fill_gradientn(colours = c("green", "white", "red"),guide=T, limits= c(-1,1))+theme(axis.text.y =element_text(size=4))
p
p=ggheat(classify_df %>% as.matrix(),clustering = "row",labRow = T)+scale_x_continuous(expand = c(0,0),limits = c(0.5,6.5),breaks = 1:6,labels = qw("E P D Gs Asym Ds"))+
scale_fill_gradientn(colours = c("green", "white", "red"), limits= c(-1,1))+theme(axis.text.y =element_text(size=4))
gg_save_pdf(p,10,28,filename = "all_class")
p=ggheat(classify_df %>% as.matrix(),clustering = "row",labRow = T)+scale_x_continuous(expand = c(0,0),limits = c(0.5,6.5),breaks = 1:6,labels = qw("E P D Gs Asym Ds"))+
scale_fill_gradientn(colours = c("green", "white", "red"), guide=F, limits= c(-1,1))+theme(axis.text.y =element_text(size=4))
gg_save_pdf(p,10,28,filename = "all_class")
View(classify_df)
SOX1145="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*200*SOX11*IIIc4*" %>% Sys.glob()
SOX1145
fjComm::gg_heat2D_diag (SOX1145[1] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[2] %>% read_csv(),  grad_colors =gg_steelblue_red )
SOX1145[2]
fjComm::gg_heat2D_diag (SOX1145[3] %>% read_csv(),  grad_colors =gg_steelblue_red )
SOX1145[3]
fjComm::gg_heat2D_diag (SOX1145[3] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[4] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[5] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[6] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[7] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[8] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[7] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1145[8] %>% read_csv(),  grad_colors =gg_steelblue_red )
SOX1145[7]
fjComm::nusel_get_147()
fjComm::nusel_get_147
fjComm::nusel_get_200
fjComm::nusel_get_200()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/all_SOXes.R', echo=TRUE)
View(SOXs)
View(SOXs)
SOXs=lig200 %>% dplyr::filter(stringr::str_detect(TF,"SOX"))
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/all_SOXes.R', echo=TRUE)
View(SOXs)
SOXs=SOXs[1:5,]
View(SOXs)
NCAP=SOXs$c4_EMI_file %>%setnames(TFnames) %>%  purrr::map(~read_csv(.,col_names = T) %>% mutate(TF=names(.)))
TFnames=SOXs$TF
NCAP=SOXs$c4_EMI_file %>%setnames(TFnames) %>%  purrr::map(~read_csv(.,col_names = T) %>% mutate(TF=names(.)))
NCAP=SOXs$c4_EMI_file %>% set_names(TFnames) %>%  purrr::map(~read_csv(.,col_names = T) %>% mutate(TF=names(.)))
SOXs$c4_EMI_file %>% set_names(TFnames)
NCAP=SOXs$c4_EMI_file %>% set_names(TFnames) %>%  purrr::map(~read_csv(.,col_names = T) %>% mutate(TF=names(.)))
NCAP=SOXs$c4_EMI_file %>% set_names(TFnames) %>%  purrr::map(~read_csv(.,col_names = T) %>% mutate(TF=.))
NCAP=SOXs$c4_EMI_file %>% set_names(TFnames) %>%  purrr::map(function(x) read_csv(x,col_names = T) %>% mutate(TF=x))
NCAP=SOXs$c4_EMI_file %>% set_names(TFnames) %>%  purrr::map(function(x) read_csv(x,col_names = T) %>% mutate(TF=names(x)))
NCAP=SOXs$c4_EMI_file %>% set_names(TFnames) %>%  purrr::map(function(x) browser && read_csv(x,col_names = T) %>% mutate(TF=names(x)))
x
TFnames=SOXs$TF
NCAP=SOXs$c4_EMI_file %>%  purrr::map2(TFnames, function(x,y) browser && read_csv(x,col_names = T) %>% mutate(TF=y))
NCAP=SOXs$c4_EMI_file %>%  purrr::map2(TFnames, function(x,y) read_csv(x,col_names = T) %>% mutate(TF=y))
NCAP=SOXs$c4_EMI_file %>%  purrr::map2(TFnames, function(x,y) read_csv(x,col_names = T) %>% mutate(TF=y)) %>% {do.call(rbind,.)}
View(NCAP)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/all_SOXes.R', echo=TRUE)
results=rbind(NCAP,HT)
View(results)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/all_SOXes.R', echo=TRUE)
View(results)
View(results)
ggplot(results)+geom_line(aes(pos1,topMIsum,color=type))+facet_wrap(~TF)
ggplot(results)+geom_line(aes(pos1,topMIsum,color=type))+facet_wrap(~TF)+ylab("E-MI (bit)")+xlab("(bp)")
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/all_SOXes.R', echo=TRUE)
results$pos1 %>% range()
ggplot(results)+geom_line(aes(pos1,topMIsum,color=type))+facet_wrap(~TF)+ylab("E-MI (bit)")+xlab("(bp)") %>% scale_x_continuous(breaks=c(1,149))
ggplot(results)+geom_line(aes(pos1,topMIsum,color=type))+facet_wrap(~TF)+ylab("E-MI (bit)")+xlab("(bp)") +scale_x_continuous(breaks=c(1,149))
ggplot(results)+geom_line(aes(pos1,topMIsum,color=type))+facet_wrap(~TF)+ylab("E-MI (bit)")+xlab("(bp)") +scale_x_continuous(breaks=c(1,149))+ theme(panel.spacing = unit(2, "lines"))
ggplot(results)+geom_line(aes(pos1,topMIsum,color=type))+facet_wrap(~TF)+ylab("E-MI (bit)")+xlab("(bp)") +scale_x_continuous(breaks=c(1,149))+ theme(panel.spacing = unit(1, "lines"))
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/all_SOXes.R', echo=TRUE)
gg_save_pdf(p,8,4)
p=ggplot(results)+geom_line(aes(pos1,topMIsum,color=type))+facet_wrap(~TF)+ylab("E-MI (bit)")+xlab("(bp)") +scale_x_continuous(breaks=c(1,149))+ theme(panel.spacing = unit(1, "lines"))
gg_save_pdf(p,8,4)
lig147=fjComm::nusel_get_147() %>% dplyr::filter(use==1&order==1)
View(lig147)
lig200=fjComm::nusel_get_200() %>% dplyr::filter(use==1 & order==1& !is.na(lig147$c5_EMI_Nu_file))
lig147=fjComm::nusel_get_147() %>% dplyr::filter(use==1 & order==1 & !is.na(lig147$c5_EMI_Nu_file))
lig147=fjComm::nusel_get_147() %>% dplyr::filter(use==1 & order==1 & !is.na(c5_EMI_Nu_file))
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/10_allTFpref/ver2/allTFpref.R', echo=TRUE)
View(classify_df)
lig147=fjComm::nusel_get_147() %>% dplyr::filter(use==1 & order==1 & !is.na(c5_EMI_Nu_file))
classify_df[,1:5]=apply(classify_df[,1:5],2,squishQuan_normalize)
View(lig147)
View(lig147)
lig147=fjComm::nusel_get_147() %>% dplyr::filter(use==1 & order==1 & !is.na(c5_EMI_Nu_file) & tag!="SBP")
View(classify_df)
rownames(classify_df)
rownames(classify_df) %in% lig147$TF
View(classify_df)
lig147=fjComm::nusel_get_147() %>% dplyr::filter(use==1 & order==1 & !is.na(c5_EMI_Nu_file))# & tag!="SBP")
View(classify_df)
View(lig147)
View(classify_df)
tt=classify_df[,6]
tt
classify_df[,6][!(rownames(classify_df) %in% lig147$TF )]=0
classify_df[,6]==tt
classify_df[,6]==tt %>% table()
(classify_df[,6]==tt) %>% table()
classify_df[,6][!(rownames(classify_df) %in% lig147$TF )]
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/10_allTFpref/ver2/allTFpref.R', echo=TRUE)
View(lig147)
classify_df[,6][!(rownames(classify_df) %in% lig147$TF )]
(classify_df[,6]==tt) %>% table()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/10_allTFpref/ver2/allTFpref.R', echo=TRUE)
x1 <- list(
c(0.27, 0.37, 0.57, 0.91, 0.20),
c(0.90, 0.94, 0.66, 0.63, 0.06),
c(0.21, 0.18, 0.69, 0.38, 0.77)
)
x2 <- list(
c(0.50, 0.72, 0.99, 0.38, 0.78),
c(0.93, 0.21, 0.65, 0.13, 0.27),
c(0.39, 0.01, 0.38, 0.87, 0.34)
)
threshold <- function(x, cutoff = 0.8) x[x > cutoff]
x1 %>% sapply(threshold) %>% str()
threshold <- function(x, cutoff = 0.8) x[x > cutoff]
x1 %>% lapply(threshold) %>% str()
map(-2:2, rnorm, n = 5)
purrr::map(-2:2, rnorm, n = 5)
purrr::map(-2:2, rnorm, n = 10)
purrr::map_dbl(-2:2, rnorm, n = 10)
purrr::map_dbl(-2:2, rnorm, n = 5)
safe_log <- safely(log)
safe_log <- purrr::safely(log)
safe_log(0)
safe_log(-1)
safe_log(2)
safe_log("a")
