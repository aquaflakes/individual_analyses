kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(1, cmbRank)
kktable %>% mutate(cmbRank=rank(ycounts)+rank(xcounts)) %>% top_n(2, cmbRank)
rank(0,4,2)
rank(c(0,4,2))
kktable %>% top_n(-1, rank(ycounts)+rank(xcounts))
kktable %>% top_n(1, rank(ycounts)+rank(xcounts))
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
p=xyplot("~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-147c4-A1-BARHL1oooNIIIc4-CCCGCGCT_S1_L003_R1_001.peared_trimmed.fq.gz",
"~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/Trulig147v1IIIFJ4-5-CAP2r-147c4-A10-VSX1IIIc4-GCTCCGAT_S10_L003_R1_001.peared_trimmed.fq.gz",
test = F,kmerLen = 4L,gapped = T,gapNo = 1,gapMins = 0,gapMaxs = 2)
print(p)
library(fjComm)
source('~/Nut_zhuData/seqFiles2/Analysis2/Nusel/170420_motif_similarity_fig3/forPHP/motif_similarity_top_kmers_xyplot_forPHP.R', echo=TRUE)
unlink("/Library/Frameworks/R.framework/Versions/3.3/Resources/library/00LOCK-fjComm",force = T)
unlink("/Library/Frameworks/R.framework/Versions/3.3/Resources/library/00LOCK-fjComm",force = T,recursive = T)
library(fjComm)
library(fjComm)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binMat
binMat[,nrow(binMat)]
binMat[,ncol(binMat)]
is.na(binMat) %>% head
any(is.na(binMat) )
binMat %>% count()
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
table(binMat)
binMat[nrow(binMat),]
binMat[nrow(binMat)-1,]
binMat[ncol(binMat)-1,]
binMat[,ncol(binMat)]
binMat[,ncol(binMat)-1]
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
scoreCurrChr %>% length()
matrix(scoreCurrChr, nrow = binsize) %>% length()
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
ncol(scoreMat)
scoreCurrChr
scoreCurrChr %>% length()
scoreCurrChr= getChrScore(topKmers=ktab$kmer,chrSeq=currSeq)
scoreCurrChr=c( rep(0,floor((kmerLen-1)/2)),scoreCurrChr,rep(0,ceiling((kmerLen-1)/2)) )
length(scoreCurrChr)
DHSLabel %>% length()
matrix(1:100, nrow = 10)
1:binzi
1:binsize
seq(1,10)
binsize*1:nrow(DHSLabel)
binsize*1:nrow(binMat)
binsize*1:nrow(binMat) %>% head
binsize*0:(nrow(binMat)-1) %>% head
binsize*0:(nrow(binMat)-1) %>% head+1
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% head()
binStarts=binsize*0:(nrow(binMat)-1)+1
binStarts=binsize*0:(nrow(binMat)-1)+1
binStarts %>% head()
binEnds %>% head
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% head()
binEnds %>% head()
binsize
debugSource('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
binStarts
binStarts %>% length()
scoreCurrChr %>% length()
binEnds %>% length()
binStarts %>% tail()
binEnds %>% tail()
allchr
rep(1,)
rep(1,3)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
print(p)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred
pred$allchrs
pred$allchrs %>% count
pred$allchrs %>% table
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
source('~/Nut_zhuData/Analysis/DHS_prediction/script/whole_genome_pred/ATI_pred_DHS_genome_prec_rec_5.R', echo=TRUE)
pred$allchrs %>% table
regions= data.frame(chr=pred$allchrs, start=pred$allbinStarts, end=pred$allbinEnds)
View(regions)
regions
read_tsv("~/Downloads/mart_export.txt") %>% head
read_tsv("~/Downloads/mart_export.txt") %>% tail
fft(c(1,1,1,1))
file="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/P24_Trulig147v1IIIFJ4-5-CAP2r-147c4-P24-SHOXIIIc4-GGTATGAA_S384_L003_R1_001.peared_trimmed.fq.gz_3mer_foldchn_maxBias.csv"
tfmi=rio::import(file)
View(tfmi)
fjComm::gg_heat2D_diag(tfmi)
tfmi %<>% dplyr::filter(pos2-pos1==3)
library(dplyr)
tfmi %<>% dplyr::filter(pos2-pos1==3)
library(magrittr)
tfmi %<>% dplyr::filter(pos2-pos1==3)
plot(0,0,type="n",main="distance_distribution",xlim=c(100,250),ylim=c(2.87297596251,9.06081360917),xlab="Distance",ylab="Percent",)
lines(c(100,110,120,130,140,150,160,170,180,190,200,210,220,230,240),c(5.4577263704,5.90807306192,5.84957266867,5.98559162931,6.24593253199,6.25670388726,6.08599167653,5.83557296687,5.58145160383,5.29335610108,4.78685760016,4.24289650923,3.7353499432,3.28804034546,2.87297596251),col="black")
lines(c(100,110,120,130,140,150,160,170,180,190,200,210,220,230,240),c(5.8583190651,6.42183883897,6.29681757886,6.20811892798,6.26494746778,6.05907097977,5.78061037105,5.52563420796,5.29365370852,5.09108413595,4.67213690049,4.1906408489,3.73037626359,3.29126677238,2.88935817048),col="gray")
lines(c(100,110,120,130,140,150,160,170,180,190,200,210,220,230,240),c(5.42649438362,7.11122092598,6.80900972806,6.60788002817,6.5855105628,6.53522813783,6.72572466176,6.26904267066,6.14955034861,5.77946974593,5.37782473845,4.6379637475,4.07521530261,3.42254216546,2.93939941476),col="red")
plot(0,0,type="n",main="fuzziness_distribution",xlim=c(31.3487378188,74.519457904),ylim=c(0.0309779394064,5.05113219782),xlab="Fuzziness",ylab="Percent",)
lines(c(31.0829184613,31.5146256622,31.946332863,32.3780400639,32.8097472648,33.2414544656,33.6731616665,34.1048688673,34.5365760682,34.968283269,35.3999904699,35.8316976707,36.2634048716,36.6951120724,37.1268192733,37.5585264741,37.990233675,38.4219408758,38.8536480767,39.2853552775,39.7170624784,40.1487696792,40.5804768801,41.0121840809,41.4438912818,41.8755984826,42.3073056835,42.7390128843,43.1707200852,43.6024272861,44.0341344869,44.4658416878,44.8975488886,45.3292560895,45.7609632903,46.1926704912,46.624377692,47.0560848929,47.4877920937,47.9194992946,48.3512064954,48.7829136963,49.2146208971,49.646328098,50.0780352988,50.5097424997,50.9414497005,51.3731569014,51.8048641022,52.2365713031,52.6682785039,53.0999857048,53.5316929056,53.9634001065,54.3951073074,54.8268145082,55.2585217091,55.6902289099,56.1219361108,56.5536433116,56.9853505125,57.4170577133,57.8487649142,58.280472115,58.7121793159,59.1438865167,59.5755937176,60.0073009184,60.4390081193,60.8707153201,61.302422521,61.7341297218,62.1658369227,62.5975441235,63.0292513244,63.4609585252,63.8926657261,64.3243729269,64.7560801278,65.1877873287,65.6194945295,66.0512017304,66.4829089312,66.9146161321,67.3463233329,67.7780305338,68.2097377346,68.6414449355,69.0731521363,69.5048593372,69.936566538,70.3682737389,70.7999809397,71.2316881406,71.6633953414,72.0951025423,72.5268097431,72.958516944,73.3902241448,73.8219313457),c(0.12800929519,0.286504279816,0.534911010475,0.206866631879,0.207509241142,3.46943976024,0.158127779333,0.447638552486,0.208128900074,0.314159428451,0.341500922565,0.51483712112,0.44971938248,0.376224773092,0.328778789182,0.462418565532,0.541734908838,0.734685990131,1.08333211569,0.684470666302,0.539019119691,0.854433166227,0.647765437215,0.81268651447,0.908580646736,1.00637965646,0.998920798944,1.09597774797,1.05382564037,1.24366312678,1.12357934583,1.27939679187,1.29368719785,1.68028552048,1.40742903739,1.65263802195,2.11074192529,1.57927346444,1.70799421988,1.73609307491,1.62844837327,1.8024348312,1.98032284536,1.8939607505,1.88738165566,2.27150899267,1.82139945456,1.77583539778,1.85618450597,1.79144162274,2.45110298142,1.85009501819,2.08382118724,1.88272273851,1.65519315878,1.47979908056,1.54545232692,1.53377060854,1.28223498278,1.20287273881,1.34197469389,1.13987408071,1.06652482342,1.0012693828,1.04207507099,1.04272533036,0.909712863056,0.849062788816,1.1195324375,0.894236689975,0.838826941271,0.98029278043,0.76975409562,0.694002703702,0.739559110375,0.703802494961,0.598827681802,0.675091631108,0.639159063158,0.691814772164,0.648989454858,0.601000313119,0.551236345796,0.530542797509,0.507118159855,0.522349529407,0.50109752307,0.479570112763,0.442949034889,0.445152266647,0.399289855564,0.401554288204,0.379506670399,0.34471396888,0.328694637969,0.304956345793,0.270308996369,0.24226369211,0.217041278542,0.186456137672),col="black")
lines(c(31.0829184613,31.5146256622,31.946332863,32.3780400639,32.8097472648,33.2414544656,33.6731616665,34.1048688673,34.5365760682,34.968283269,35.3999904699,35.8316976707,36.2634048716,36.6951120724,37.1268192733,37.5585264741,37.990233675,38.4219408758,38.8536480767,39.2853552775,39.7170624784,40.1487696792,40.5804768801,41.0121840809,41.4438912818,41.8755984826,42.3073056835,42.7390128843,43.1707200852,43.6024272861,44.0341344869,44.4658416878,44.8975488886,45.3292560895,45.7609632903,46.1926704912,46.624377692,47.0560848929,47.4877920937,47.9194992946,48.3512064954,48.7829136963,49.2146208971,49.646328098,50.0780352988,50.5097424997,50.9414497005,51.3731569014,51.8048641022,52.2365713031,52.6682785039,53.0999857048,53.5316929056,53.9634001065,54.3951073074,54.8268145082,55.2585217091,55.6902289099,56.1219361108,56.5536433116,56.9853505125,57.4170577133,57.8487649142,58.280472115,58.7121793159,59.1438865167,59.5755937176,60.0073009184,60.4390081193,60.8707153201,61.302422521,61.7341297218,62.1658369227,62.5975441235,63.0292513244,63.4609585252,63.8926657261,64.3243729269,64.7560801278,65.1877873287,65.6194945295,66.0512017304,66.4829089312,66.9146161321,67.3463233329,67.7780305338,68.2097377346,68.6414449355,69.0731521363,69.5048593372,69.936566538,70.3682737389,70.7999809397,71.2316881406,71.6633953414,72.0951025423,72.5268097431,72.958516944,73.3902241448,73.8219313457),c(0.0726146695838,0.188455993547,0.416633158372,0.134010265796,0.120759692413,3.40277015647,0.0881182223031,0.304007103224,0.131253230066,0.212123732403,0.225817264436,0.407277566214,0.319266264964,0.244956132965,0.205502264321,0.311919261163,0.385144908194,0.582192772091,0.869650023717,0.479013955718,0.371375003981,0.647445163438,0.472262654928,0.630689106952,0.680728159867,0.82525487497,0.780302209302,0.88302279259,0.855162221004,1.01377196626,0.932030821063,1.08855560578,1.12197607214,1.52218921162,1.27299442262,1.50301979422,1.9618791314,1.47436495195,1.62457375731,1.66864050568,1.58729649582,1.78719304207,1.9967124831,1.89732936412,1.95403570842,2.37350991193,1.93382762936,1.90527207093,2.01730242307,1.9748394905,2.70772984991,2.05902454548,2.36756815625,2.13676378841,1.91187826458,1.73597785757,1.78903361163,1.77016204573,1.51738540144,1.4395086886,1.53781495983,1.3556596712,1.25464982477,1.18806855747,1.20414490155,1.19862319287,1.06001532179,0.987919983033,1.26590708423,1.02302063737,0.971148652111,1.11608013977,0.861081065022,0.797455401128,0.837940294215,0.787282626635,0.686960129827,0.747973865134,0.714202086748,0.769755211122,0.711857460795,0.660772109002,0.607838550432,0.573577990087,0.54576324181,0.560251044523,0.535911230476,0.506233000985,0.468054547761,0.470544280858,0.411080900822,0.415548673404,0.382624626225,0.34692826888,0.327460999973,0.30366342841,0.265568984585,0.238601967515,0.209007747423,0.179360066804),col="gray")
lines(c(31.0829184613,31.5146256622,31.946332863,32.3780400639,32.8097472648,33.2414544656,33.6731616665,34.1048688673,34.5365760682,34.968283269,35.3999904699,35.8316976707,36.2634048716,36.6951120724,37.1268192733,37.5585264741,37.990233675,38.4219408758,38.8536480767,39.2853552775,39.7170624784,40.1487696792,40.5804768801,41.0121840809,41.4438912818,41.8755984826,42.3073056835,42.7390128843,43.1707200852,43.6024272861,44.0341344869,44.4658416878,44.8975488886,45.3292560895,45.7609632903,46.1926704912,46.624377692,47.0560848929,47.4877920937,47.9194992946,48.3512064954,48.7829136963,49.2146208971,49.646328098,50.0780352988,50.5097424997,50.9414497005,51.3731569014,51.8048641022,52.2365713031,52.6682785039,53.0999857048,53.5316929056,53.9634001065,54.3951073074,54.8268145082,55.2585217091,55.6902289099,56.1219361108,56.5536433116,56.9853505125,57.4170577133,57.8487649142,58.280472115,58.7121793159,59.1438865167,59.5755937176,60.0073009184,60.4390081193,60.8707153201,61.302422521,61.7341297218,62.1658369227,62.5975441235,63.0292513244,63.4609585252,63.8926657261,64.3243729269,64.7560801278,65.1877873287,65.6194945295,66.0512017304,66.4829089312,66.9146161321,67.3463233329,67.7780305338,68.2097377346,68.6414449355,69.0731521363,69.5048593372,69.936566538,70.3682737389,70.7999809397,71.2316881406,71.6633953414,72.0951025423,72.5268097431,72.958516944,73.3902241448,73.8219313457),c(0.0309779394064,0.0490466586274,0.0644274115038,0.0483275403586,0.053375331702,0.254679574863,0.0567125990079,0.0902249066822,0.077937060535,0.0947490682182,0.106310814366,0.124547095125,0.137246863388,0.143453622038,0.159630292222,0.191194697012,0.208292955657,0.237846621987,0.287284257538,0.291654820997,0.307489386373,0.358469984422,0.378277154604,0.430158395922,0.480447802626,0.519901563182,0.579504598726,0.633473377544,0.688398653475,0.767690169779,0.81221266687,0.902039614899,0.974719432167,1.07377622827,1.14119182054,1.23985065799,1.35837950119,1.41942077327,1.51440023861,1.61065037894,1.69686777216,1.81142401056,1.91062742301,2.00789689603,2.07845426715,2.18551212671,2.23347661707,2.29353346511,2.35274552373,2.4022320314,2.47003161886,2.44773895253,2.45189308233,2.42541835927,2.37392111314,2.30682668049,2.24822203244,2.15543483057,2.04323143544,1.94049526722,1.83894599324,1.72696601349,1.6181068674,1.52097702899,1.44128755403,1.36873340792,1.29783393199,1.24132380318,1.21229376665,1.15088246284,1.11419346767,1.08443733115,1.03372203887,0.993241963888,0.955624398524,0.921462789888,0.874615376452,0.853746983194,0.816248107253,0.789766402459,0.750207915942,0.718692383267,0.685005532323,0.659780539068,0.627378326585,0.601364397753,0.57534348719,0.548791965089,0.523783405487,0.502237784345,0.473089058399,0.454189513217,0.43114281996,0.407286245935,0.390348567098,0.369263740186,0.352479659426,0.328909336361,0.309870156564,0.294838490226),col="red")
legend("topright",legend=c("GP5dFixed","LoVo","LoVoFixed"),col=c("black","gray","red"),lty=1)
pacman::p_load(QuasR)
file.copy(system.file(package="QuasR", "extdata"), ".", recursive=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/test/map_to_genome.R')
head(auxFile)
head(auxFile %>% read_csv())
library(fjComm)
library(devtools)
pacman::p_load(DBI)
library(dplyr)
pacman::p_load(BSgenome.Mmusculus.UCSC.mm9,BSgenome.Mmusculus.UCSC.mm9.masked)
library(BSgenome.Mmusculus.UCSC.mm9.masked)
library(BSgenome.Mmusculus.UCSC.mm9)
pacman::p_load(BSgenome.Mmusculus.UCSC.mm9, BSgenome.Mmusculus.UCSC.mm9.masked)
chunkPE <- readGAlignmentPairs(bamFile,strandMode = T)
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/fromOthers/Eevi/LoVo_DNase/LoVo_DNase_rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignments(bamFile,strandMode = T)
close(bamFile)
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/fromOthers/Eevi/LoVo_DNase/LoVo_DNase_rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignments(bamFile)
close(bamFile)
chunkPE
?`readGAlignments,BamFile-method`
pacman::p_load(BSgenome)
pacman::p_load(BSgenome,BSgenome.Hsapiens.UCSC.hg19.masked)
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.tsv")
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
bedfile=rtracklayer::import("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
bedfile=read_tsv("~/Nut_zhuData/DefaultFilesforProc/Blacklist/hg19_blacklist_MergedList.bed")
View(bedfile)
?getSeq
bedfile
View(bedfile)
source('~/.active-rstudio-document')
pacman::p_load(BSgenome,BSgenome.Hsapiens.UCSC.hg19.masked,GenomicRanges)
source('~/.active-rstudio-document')
bedRanges
source('~/.active-rstudio-document')
black_sequences
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/seqFiles2/FJ7.1MNase/analysis/align/testout/FJ7-1-1-MNaseTest-B5-GP5dFixed-x4MNase-GCCGAATT_S1_L004.sorted.rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignments(bamFile,use.names = )
close(bamFile)
chunkPE
library(GenomicAlignments)
library(Rsamtools)
bamFile= BamFile(file = "~/Nut_zhuData/seqFiles2/FJ7.1MNase/analysis/align/testout/FJ7-1-1-MNaseTest-B5-GP5dFixed-x4MNase-GCCGAATT_S1_L004.sorted.rmdup.bam",yieldSize = 10000)
# bamFile= BamFile(file = "trimmed/FJ7-1-1-MNaseTest-E7-LoVo-x16MNase-ATATTCCG_S2_L007_R1_001_val_1_3d850add768.bam",yieldSize = 1000000,asMates = T)
open(bamFile)
chunkPE <- readGAlignmentPairs(bamFile,use.names = )
close(bamFile)
chunkPE
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
library(fjComm)
source('~/Nut_zhuData/lib/Rlib/PKG/fjComm/R/2017_04_27_SELEX_utilities.R', echo=TRUE)
pacman::p_load(tidyverse)
map(c(1,2,3),max)
is.factor(iris)
iris %>%
keep(is.factor)
iris %>%
keep(is.numeric())
iris %>%
keep(is.numeric)
dfs <- list(
age = tibble(name = "John", age = 30),
sex = tibble(name = c("John", "Mary"), sex = c("M", "F")),
trt = tibble(name = "Mary", treatment = "A")
)
dfs
c(1,2,3) %>% cumsum()
diamonds %>%
count(cut_width(carat, 0.5))
parse_logical("TRUESLJ")
parse_number("TR3UESLJ")
parse_number("TR3UESL4J")
guess_encoding(charToRaw(x2))
iris %>% count(Species)
x <- c("apple", "banana", "pear")
str_view(x, "an")
library(stringr)
x <- c("apple", "banana", "pear")
str_view(x, "an")
x <- c("apple", "banana", "pear")
str_view(x, "..a")
x <- c("apple", "banana", "pear")
str_view(c("ACTAC","TCAT"), "..a")
x <- c("apple", "banana", "pear")
str_view(c("ACTAC","TCAT"), "..A")
iris$Species %>% str_view("to")
iris$Species %>% as.character() %>%  str_view("to")
rep("N",30) %>% str_c()
rep("N",30) %>% str_c(collapse = "")
list(aa=list(bb=1,cc=1),dd=2)
list(aa=list(bb=1,cc=1),dd=2) %>% flatten_int()
list(aa=list(bb=1,cc=1),dd=2) %>% flatten
rnorm(100) %>%
matrix(ncol = 2)
rnorm(100) %>%
matrix(ncol = 2) %>% plot
rnorm(100) %>%
matrix(ncol = 2) %>% plot %>% str()
rnorm(100) %>%
matrix(ncol = 2) %T>% plot %>% str()
library(gapminder)
pacman::p_load()
pacman::p_load(gapminder)
by_country <- gapminder %>%
group_by(country, continent)
gapminder %>%
group_by(country, continent)
gapminder %>%
group_by(country, continent) %>% nest
by_country=gapminder %>%
group_by(country, continent) %>% nest
by_country$data
fjComm::calc_Vplot
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/1_ELF_asym/ELF1.R', echo=TRUE)
ELF5="~/Nut_zhuData/seqFiles2/FJ4.6CAPFLLin/allreads/pear_and_trimmed/*ELF5*" %>% Sys.glob()
ELF5
ELF5="~/Nut_zhuData/seqFiles2/FJ4.6CAPFLLin/allreads/pear_and_trimmed/*ELF5IIIc4*" %>% Sys.glob()
ELF5
ELF5="~/Nut_zhuData/seqFiles2/FJ4.6CAPFLLin/allreads/pear_and_trimmed/*1nu50L*ELF5IIIc4*" %>% Sys.glob()
ELF5
ELF5="~/Nut_zhuData/seqFiles2/FJ4.6CAPFLLin/allreads/pear_and_trimmed/*1nu50L*B20*ELF5IIIc4*" %>% Sys.glob()
ELF5="~/Nut_zhuData/seqFiles2/FJ4.6CAPFLLin/allreads/pear_and_trimmed/*1nu50L*B21*ELF5IIIc4*" %>% Sys.glob()
ELF5
ELF5="~/Nut_zhuData/seqFiles2/FJ4.6CAPFLLin/allreads/pear_and_trimmed/*1nu50L*B21*ELF5IIIc4*" %>% Sys.glob() %>% .[1]
motif="~/Nut_zhuData/Analysis/Analysis2/Nusel_revise/1_motif_and_HTctrl/manual_curations/3_curated_motifs_and_make_table/NCAP_motifs/*ELF*" %>% Sys.glob()
motif
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/1_ELF_asym/ELF1.R', echo=TRUE)
motif %>% read_tsv()
motif %>% read_csv()
motif="~/Nut_zhuData/Analysis/Analysis2/Nusel_revise/1_motif_and_HTctrl/manual_curations/3_curated_motifs_and_make_table/NCAP_motifs/*ELF5*" %>% Sys.glob()
motif %>% read_csv()
motif %>% read_tsv()
motif %>% read_tsv(col_names = F)
motif %>% read_tsv(col_names = F) %>% fjComm::ggseqlogo_lab()
motif %>% read_tsv(col_names = F) %>% as.matrix() %>% fjComm::ggseqlogo_lab()
result=fjComm::motif_plot_moods_singlePWM_hit(ELF5,motif)
result
ELF="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/*ELF*IIIc4*" %>% Sys.glob()# %>% .[1]
ELF
ELF="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/*147c4*ELF*IIIc4*" %>% Sys.glob()# %>% .[1]
ELF="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/*-147c4-*ELF*IIIc4*" %>% Sys.glob()# %>% .[1]
ELF
result+scale_fill_gradientn(c("green","red"))
result+scale_fill_gradientn(colours = c("green","red"))
result+scale_fill_gradientn(colours = c("green","red"),guide = T)
result+scale_fill_gradientn(colours = c("green","red"),guide = T)+theme_base()
result$data
ELF
motif="~/Nut_zhuData/Analysis/Analysis2/Nusel_revise/1_motif_and_HTctrl/manual_curations/3_curated_motifs_and_make_table/NCAP_motifs/*ELF*" %>% Sys.glob()
motif
ELF
ELF[1]
ELF[1]
ELF[1] %>% str_extract()
ELF[1] %>% fjComm::extract_TF()
ELF %>% fjComm::extract_TF()
ELF %>% purrr::map(fjComm::extract_TF())
ELF %>% purrr::map(fjComm::extract_TF)
ELF %>% purrr::map(fjComm::extract_TF) %>% unlist()
order=ELF %>% purrr::map(fjComm::extract_TF) %>% unlist()
motif
motif[1] %>% str_extract("\\.ELF.\\.c")
motif[1] %>% str_extract("(?<=\\.)ELF.\\.c")
motif[1] %>% str_extract("(?<=\\.)ELF.(?=\\.c)")
motif[1] %>% str_extract("(?<=\\.)ELF.(?=\\.c)")
motif %>% purrr::map(str_extract("(?<=\\.)ELF.(?=\\.c)"))
motif %>% purrr::map(str_extract(.,"(?<=\\.)ELF.(?=\\.c)"))
motif %>% purrr::map(~str_extract(.,"(?<=\\.)ELF.(?=\\.c)"))
order1=ELF %>% purrr::map(fjComm::extract_TF) %>% unlist()
order2=motif %>% purrr::map(~str_extract(.,"(?<=\\.)ELF.(?=\\.c)")) %>% unlist()
identical(order1,order2)
order1
order2
ELF="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/allreads/Adpt_Trimmed_Reads/2_Trim_adaptor_kmer/*-147c4-*ELF*IIIc4*" %>% Sys.glob()# %>% .[1]
motif="~/Nut_zhuData/Analysis/Analysis2/Nusel_revise/1_motif_and_HTctrl/manual_curations/3_curated_motifs_and_make_table/NCAP_motifs/*ELF*" %>% Sys.glob()
order1=ELF %>% purrr::map(fjComm::extract_TF) %>% unlist()
order2=motif %>% purrr::map(~str_extract(.,"(?<=\\.)ELF.(?=\\.c)")) %>% unlist()
results=purrr::map(1:4,~fjComm::motif_plot_moods_singlePWM_hit(ELF[.],motif[.]))
results[1]
results[2]
results[3]
results[4]
results[3]
order
results[4]
results[2]
results[4]
result
ELF1=results[2] %>% gg_save_diag(height = 2.5,newName = "ELF1")
ELF1=results[[2]] %>% gg_save_diag(height = 2.5,newName = "ELF1")
ELF2=results[[4]] %>% gg_save_diag(height = 2.5,newName = "ELF2")
ELF1=results[[2]] %>% gg_save_diag(width = 3, height = 2,newName = "ELF1")
ELF2=results[[4]] %>% gg_save_diag(width = 3, height = 2,newName = "ELF2")
ELF1=results[[2]] %>% gg_save_diag(width = 3.5, height = 2,newName = "ELF1")
ELF2=results[[4]] %>% gg_save_diag(width = 3.5, height = 2,newName = "ELF2")
result
result+scale_fill_gradientn(colors = c("green","red"),values = c(0,1))
result+scale_fill_gradientn(colors = c("green","red"),values = c(-1,1))
results+geom_vline(xintercept = 1)
results+geom_vline(xintercept = 2)
result+geom_vline(xintercept = 1)
result+geom_vline(xintercept = 50)
result+geom_vline(xintercept = c(50,91))
result+geom_vline(xintercept = c(50,90))
result+geom_vline(xintercept = c(50,91))
result$data
result$data$pos %>% hist()
result$data$pos %>% ggplot()+geom_histogram(binwidth = 1)
result$data %>% ggplot()+geom_histogram(aes(pos),binwidth = 1)
(result$data %>% ggplot())+geom_histogram(aes(pos),binwidth = 1)
(result$data %>% ggplot())+geom_histogram(aes(pos),binwidth = 0.1)
(result$data %>% ggplot())+geom_histogram(aes(pos),bins=200)
(result$data %>% ggplot())+geom_polygon(aes(pos,count),binwidth = 1)
(result$data %>% dplyr::filter(strand=="+") %>% ggplot())+geom_polygon(aes(pos,count))
(result$data %>% dplyr::filter(strand=="+") %>% ggplot())+geom_line(aes(pos,count))
result_mut=result
result_mut=result
result_mut %<>% mutate(pos=ifelse(pos>60,pos1+117,pos))
result_mut=result
result_mut$data %<>% mutate(pos=ifelse(pos>60,pos1+117,pos))
result_mut$data %<>% mutate(pos=ifelse(pos>60,pos+117,pos))
result_mut
motif
pwm=motif %>% read_tsv(col_names = F) %>% as.matrix()
pwm=motif %>% read_tsv(col_names = F) %>% as.matrix()
motif
motif_lin="~/Nut_zhuData/Analysis/Analysis2/Nusel_revise/1_motif_and_HTctrl/manual_curations/3_curated_motifs_and_make_table/NCAP_motifs/*ELF5*" %>% Sys.glob()
pwm=motif_lin %>% read_tsv(col_names = F) %>% as.matrix()
pwm
result_mut+scale_x_continuous(breaks = c(1,141+117))
result_mut+scale_x_continuous(breaks = c(1,141+117),expand = c(0,0))
result_mut
result_mut=result_mut+scale_x_continuous(breaks = c(1,141+117),expand = c(0,0))
result_mut
result_mut+geom_vline(xintercept = c(45))
result_mut+geom_vline(xintercept = c(45,258-45))
ELF5Lin=result_mut %>% gg_save_diag(width = 6.5, height = 2,newName = "ELF5Lin")
result_mut=result
result_mut$data %<>% mutate(pos=ifelse(pos>60,pos+117,pos))
result_mut=result_mut+scale_x_continuous(breaks = c(1,141+117),expand = c(0,0))+geom_vline(xintercept = c(45,258-45))
ELF5Lin=result_mut %>% gg_save_diag(width = 6.5, height = 2,newName = "ELF5Lin")
result_mut=result_mut+scale_x_continuous(breaks = c(1,141+117),expand = c(0,0))+geom_vline(xintercept = c(45,258-45),color="grey")
ELF5Lin=result_mut %>% gg_save_diag(width = 6.5, height = 2,newName = "ELF5Lin")
mnase_occu=read_tsv("K562_merged_rep1_*.txt" %>% Sys.glob(),col_names = T) %>% set_names(c("motif","MNase occupancy"))
debugSource('/Volumes/bkup_Nut_zhuData/Nut_zhuData/Analysis/Analysis2/Nusel_revise/MNase_occupancy_corr/USE_larger140/corr.R', echo=TRUE)
selected=c("ATF2","ATF3","ELF1","HMBOX1","YBX1","PKNOX1")
filter_out=!names(EMI_penetration) %>% str_detect("CREB1")
p=(ggplot()+geom_point(aes(avg_occupancy[filter_out],EMI_penetration[filter_out],text=names(avg_occupancy[filter_out])))) + xlab("MNase-seq coverage") + ylab("E-MI penetration (bp)")+
scale_y_continuous(breaks = c(10,50)) + scale_x_continuous(breaks = c(5,9))+geom_point(aes(avg_occupancy[selected],EMI_penetration[selected],text=names(avg_occupancy[selected])),color="black")
library(grid)
my_grob=grobTree(textGrob("r=0.6, p=0.008",x=0.1, y=0.85,hjust=0, gp=gpar(fontsize=9,fontface="italic")))
p=p+ annotation_custom(my_grob)
p %>% plotly::ggplotly() %T>% print()
filter_out=!names(EMI_penetration) %>% str_detect("YBX1|CTCF|CREB1")
filter_out
filter_out=
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
debugSource('/Volumes/bkup_Nut_zhuData/Nut_zhuData/Analysis/Analysis2/Nusel_revise/MNase_occupancy_corr/USE_larger140/corr.R', echo=TRUE)
source('/Volumes/bkup_Nut_zhuData/Nut_zhuData/Analysis/Analysis2/Nusel_revise/MNase_occupancy_corr/USE_larger140/corr.R', echo=TRUE)
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("YBX1|CTCF|CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("YBX1|CTCF|CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
source('/Volumes/bkup_Nut_zhuData/Nut_zhuData/Analysis/Analysis2/Nusel_revise/MNase_occupancy_corr/USE_larger140/corr.R', echo=TRUE)
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("YBX1|CTCF|CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=TRUE
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("YBX1|CTCF|CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
p %>% plotly::ggplotly() %T>% print()
filter_out=!names(EMI_penetration) %>% str_detect("YBX1|CTCF")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=TRUE
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=TRUE
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
filter_out=!names(EMI_penetration) %>% str_detect("YBX1|CTCF|CREB1")
cor.test(avg_occupancy[filter_out],EMI_penetration[filter_out])
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/2_ELF_Vplot/NUoccupancy/ELF2/ELF2_sig_bk.R', echo=TRUE)
View(plotdf)
2989/3
View(plotdf)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/Nu_CG_pref/Nu_CG_pref.R', echo=TRUE)
kcounts=kmerCntBit_file(file = "AAAAAAAAAAA",k = 9L,diffLen = F,collapse = T,asDf = T,all_possible_k = T,pseudo = 5,rmdup = T,bkfile = cyc5ub)
kcounts=kmerCntBit(file = "AAAAAAAAAAA",k = 9L,diffLen = F,collapse = T,asDf = T,all_possible_k = T,pseudo = 5,rmdup = T,bkfile = cyc5ub)
kcounts=kmerCntBit( "AAAAAAAAAAA",k = 9L,diffLen = F,collapse = T,asDf = T,all_possible_k = T,pseudo = 5,rmdup = T,bkfile = cyc5ub)
kcounts=kmerCntBit( "AAAAAAAAAAA",k = 9L,diffLen = F,collapse = T,asDf = T,all_possible_k = T,pseudo = 5)
kcounts %<>% mutate(C=str_count(kmer,"C"),G=str_count(kmer,"G"),CG=str_count(kmer,"CG")) %>% .[sample(1:nrow(kcounts)),]
head(kcounts)
table(kcounts$C)
table(kcounts$G)
table(kcounts$CG)
t.test(c(1,2,3,4),c(2,3,4,5))
t.test(c(1,2,3,4),c(2,3,4,5),paired = T)
t.test(c(1,2,3,4),c(2,3,4,5))
t.test(c(1,2,3,4),c(2,3,4,5),paired = T)
t.test(c(1,2,3,4),c(2,3,4,5,6),paired = T)
t.test(x = c(1,2,3,4),y = c(2,3,4,5),paired = T)
t.test(x = c(1,1,2,4),y = c(2,3,4,5),paired = T)
t.test(x = c(1:20),y = c(21:40),paired = T)
t.test(x = c(1:10,21:30),y = c(21:40),paired = T)
t.test(x = c(1:10,21:30),y = c(21:40),paired = F)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/4_classify_EMIdiag/PCA/EMI_diag_classify.R', echo=TRUE)
View(NCAPdiags)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/9_EMIp_corr_147_200/147_200_corr.R', echo=TRUE)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise1/9_EMIp_corr_147_200/147_200_corr.R', echo=TRUE)
View(plotdf)
version
packageVersion("circlize")
packageVersion("shortReads")
sessionInfo()
p_load(NMF)
sessionInfo()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/SOX12.R', echo=TRUE)
SOX12="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*SOX12*" %>% Sys.glob()
SOX12
SOX12="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*SOX12*IIIc4*" %>% Sys.glob()
SOX12="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*200*SOX12*IIIc4*" %>% Sys.glob()
SOX12
SOX1244="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*200*SOX12*IIIc4*" %>% Sys.glob()
SOX1245="~/Nut_zhuData/seqFiles2/FJ4.4CAP2_PE/analysis/2d_IC_related_pub/data/*SOX12*" %>% Sys.glob()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/!ADD_Nat_revise2/2_SOX12/SOX12.R', echo=TRUE)
SOX1244
NCAP200=SOX1244[2] %>% read_csv()
View(NCAP200)
fjComm::gg_heat2D_diag(NCAP200)
fjComm::gg_heat2D_diag(NCAP200, grad_colors =gg_steelblue_red )
fjComm::gg_heat2D(NCAP200, grad_colors =gg_steelblue_red )
fjComm::ggheat(NCAP200, grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_MI (NCAP200,  grad_colors = =gg_steelblue_red )
fjComm::gg_heat2D_MI (NCAP200,  grad_colors =gg_steelblue_red )
SOX1245
SOX12NCAP="/Volumes/bkup_8T2/Nut_zhuData/Reads_for_manuscript/1_Reads_Nu_SELEX/raw_reads_all_batches/*SOX12*cycle-4*" %>% Sys.glob()
SOX12NCAP
SOX12NCAP="/Volumes/bkup_8T2/Nut_zhuData/Reads_for_manuscript/1_Reads_Nu_SELEX/uploaded/*SOX12*cycle-4*" %>% Sys.glob()
SOX12NCAP="/Volumes/bkup_8T2/Nut_zhuData/Reads_for_manuscript/1_Reads_Nu_SELEX/uploaded/*SOX12*cycle-4*" %>% Sys.glob()
SOX12NCAP
NCAP200=SOX1244[1] %>% read_csv(); fjComm::gg_heat2D_MI (NCAP200,  grad_colors =gg_steelblue_red )
NCAP200=SOX1244[1]; fjComm::gg_heat2D_MI (NCAP200 %>% read_csv(),  grad_colors =gg_steelblue_red )
NCAP200=SOX1244[1] %T>% print() ; fjComm::gg_heat2D_MI (NCAP200 %>% read_csv(),  grad_colors =gg_steelblue_red )
NCAP200=SOX1245[1] %T>% print() ; fjComm::gg_heat2D_MI (NCAP200 %>% read_csv(),  grad_colors =gg_steelblue_red )
NCAP200=SOX1245[1] %T>% print() ; fjComm::gg_heat2D_diag (NCAP200 %>% read_csv(),  grad_colors =gg_steelblue_red )
NCAP200=SOX1245[2] %T>% print() ; fjComm::gg_heat2D_diag (NCAP200 %>% read_csv(),  grad_colors =gg_steelblue_red )
NCAP200=fjComm::gg_heat2D_diag (SOX1245[1] %>% read_csv(),  grad_colors =gg_steelblue_red )
HT200=fjComm::gg_heat2D_diag (SOX1245[2] %>% read_csv(),  grad_colors =gg_steelblue_red )
HT200
NCAP200
NCAP200_data=NCAP200$data
NCAP200=fjComm::gg_heat2D_diag (SOX1245[1] %>% read_csv(),  grad_colors =gg_steelblue_red )
NCAP200_data=NCAP200$data
NCAP200$data
NCAP200
NCAP200 %>% str()
plotdf=rbind(SOX1245[1] %>% read_csv() %>% mutate(type="NCAP"), SOX1245[2] %>% read_csv() %>% mutate(type="HT"))
View(plotdf)
plotdf=rbind(SOX1245[1] %>% read_csv() %>% mutate(type="NCAP"), SOX1245[2] %>% read_csv() %>% mutate(type="HT")) %>% dplyr::filter(pos2-pos1==3)
View(plotdf)
ggplot(plotdf) + geom_line(aes(pos1,topMIsum,color=type))
SOX1245
NCAP200=fjComm::gg_heat2D_diag (SOX1245[3] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1245[4] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1245[3] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1245[4] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1245[5] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1245[6] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1245[7] %>% read_csv(),  grad_colors =gg_steelblue_red )
fjComm::gg_heat2D_diag (SOX1245[8] %>% read_csv(),  grad_colors =gg_steelblue_red )
plotdf=rbind(SOX1245[1] %>% read_csv() %>% mutate(type="NCAP"), SOX1245[2] %>% read_csv() %>% mutate(type="HT")) %>% dplyr::filter(pos2-pos1==3)
ggplot(plotdf) + geom_line(aes(pos1,topMIsum,color=type))
ggplot(plotdf) + geom_line(aes(pos1,topMIsum,color=type))+ylab("E-MI (bit)")+xlab("(bp)")
