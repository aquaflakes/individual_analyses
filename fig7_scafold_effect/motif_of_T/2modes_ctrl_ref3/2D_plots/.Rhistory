iris %>%
keep(is.numeric())
iris %>%
keep(is.numeric)
dfs <- list(
age = tibble(name = "John", age = 30),
sex = tibble(name = c("John", "Mary"), sex = c("M", "F")),
trt = tibble(name = "Mary", treatment = "A")
)
dfs
c(1,2,3) %>% cumsum()
diamonds %>%
count(cut_width(carat, 0.5))
parse_logical("TRUESLJ")
parse_number("TR3UESLJ")
parse_number("TR3UESL4J")
guess_encoding(charToRaw(x2))
iris %>% count(Species)
x <- c("apple", "banana", "pear")
str_view(x, "an")
library(stringr)
x <- c("apple", "banana", "pear")
str_view(x, "an")
x <- c("apple", "banana", "pear")
str_view(x, "..a")
x <- c("apple", "banana", "pear")
str_view(c("ACTAC","TCAT"), "..a")
x <- c("apple", "banana", "pear")
str_view(c("ACTAC","TCAT"), "..A")
iris$Species %>% str_view("to")
iris$Species %>% as.character() %>%  str_view("to")
rep("N",30) %>% str_c()
rep("N",30) %>% str_c(collapse = "")
list(aa=list(bb=1,cc=1),dd=2)
list(aa=list(bb=1,cc=1),dd=2) %>% flatten_int()
list(aa=list(bb=1,cc=1),dd=2) %>% flatten
rnorm(100) %>%
matrix(ncol = 2)
rnorm(100) %>%
matrix(ncol = 2) %>% plot
rnorm(100) %>%
matrix(ncol = 2) %>% plot %>% str()
rnorm(100) %>%
matrix(ncol = 2) %T>% plot %>% str()
library(gapminder)
pacman::p_load()
pacman::p_load(gapminder)
by_country <- gapminder %>%
group_by(country, continent)
gapminder %>%
group_by(country, continent)
gapminder %>%
group_by(country, continent) %>% nest
by_country=gapminder %>%
group_by(country, continent) %>% nest
by_country$data
fjComm::calc_Vplot
source('/Volumes/bkup_Nut_zhuData/Nut_zhuData/Analysis/Analysis2/Nusel_revise/ATImotifMap/batch1_liver_used/liver/c0_bk_sub.R', echo=TRUE)
bound_fft=fjComm::fft_raw(boundc2/boundc2_reads) %>% mutate(Type="Bound")
unbound_fft=fjComm::fft_raw(uboundc2/uboundc2_reads) %>% mutate(Type="Dissociated")
bound_fft=fjComm::fft_raw(boundc2/boundc2_reads) %>% mutate(Type="Bound")
unbound_fft=fjComm::fft_raw(uboundc2/uboundc2_reads) %>% mutate(Type="Dissociated")
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("x"^-1))
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")
gg_save_pdf(fft_p,8,6,filename = "fft_b_ub")
fft_p=ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")
gg_save_pdf(fft_p,8,6,filename = "fft_b_ub")
gg_save_pdf(fft_p,7,6,filename = "fft_b_ub")
gg_save_pdf(fft_p,8,5,filename = "fft_b_ub")
fft_p=
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.justification = c(0.5,0.9))
fft_p=
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.justification = c(0.5,0.9))
fft_p=
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.justification = "center")
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.justification = c(0.5,0.9))
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.justification = c(0.3,0.9))
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.justification = "left")
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.position = c(0.8,0.9))
fft_p=
ggplot(rbind(bound_fft,unbound_fft))+geom_line(aes(x_axis,norm_pow,color=Type))+xlab(expression("bp"^-1))+ylab("Power spectra density")+theme(legend.position = c(0.8,0.9))
gg_save_pdf(fft_p,7,5,filename = "fft_b_ub")
gg_save_pdf(fft_p,6,4,filename = "fft_b_ub")
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
p
View(plotdf)
p=p+ stat_summary(color="red",alpha=0.5) + gg_axis_x_labels(c("Mode 2 (Rnd)", "Bk (Rnd)", "Mode 2 (T)", "Bk (T)")) +
ylab(expression("Log"[2]^"(E-MI"[b]*"/E-MI"[ub]*")"))+
geom_path(data=data.frame(x=c(1,1,2,2),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=1.5,y=0.33,size=9/3,label= paste0("p=",signif(pvalCtrl,2)))+
gg_theme_Publication()+scale_y_continuous()+ theme(axis.title.x = element_blank(),axis.text.x = element_text(size=9))+ gg_axis_x_label_angle()+
geom_path(data=data.frame(x=c(3,3,4,4),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=3.5,y=0.33,size=9/3,label= paste0("p=",signif(pval,2)))
p
p=p+ stat_summary(color="red",alpha=0.5) + gg_axis_x_labels(c("Mode 2 (Rnd)", "Bk (Rnd)", "Mode 2 (T)", "Bk (T)")) +
ylab(expression("Log"^2*"(E-MI"[b]*"/E-MI"[ub]*")"))+
geom_path(data=data.frame(x=c(1,1,2,2),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=1.5,y=0.33,size=9/3,label= paste0("p=",signif(pvalCtrl,2)))+
gg_theme_Publication()+scale_y_continuous()+ theme(axis.title.x = element_blank(),axis.text.x = element_text(size=9))+ gg_axis_x_label_angle()+
geom_path(data=data.frame(x=c(3,3,4,4),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=3.5,y=0.33,size=9/3,label= paste0("p=",signif(pval,2)))
p
p=p+ stat_summary(color="red",alpha=0.5) + gg_axis_x_labels(c("Mode 2 (Rnd)", "Bk (Rnd)", "Mode 2 (T)", "Bk (T)")) +
ylab(expression("Log"[2*"(E-MI"[b]*"/E-MI"[ub]*")"))+
geom_path(data=data.frame(x=c(1,1,2,2),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=1.5,y=0.33,size=9/3,label= paste0("p=",signif(pvalCtrl,2)))+
gg_theme_Publication()+scale_y_continuous()+ theme(axis.title.x = element_blank(),axis.text.x = element_text(size=9))+ gg_axis_x_label_angle()+
geom_path(data=data.frame(x=c(3,3,4,4),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=3.5,y=0.33,size=9/3,label= paste0("p=",signif(pval,2)))
gg_save_pdf(p,width = 7,height = 6,filename = "ctrl_2_modes")
p=p+ stat_summary(color="red",alpha=0.5) + gg_axis_x_labels(c("Mode 2 (Rnd)", "Bk (Rnd)", "Mode 2 (T)", "Bk (T)")) +
ylab(expression("Log"[2]*"(E-MI"[b]*"/E-MI"[ub]*")"))+
geom_path(data=data.frame(x=c(1,1,2,2),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=1.5,y=0.33,size=9/3,label= paste0("p=",signif(pvalCtrl,2)))+
gg_theme_Publication()+scale_y_continuous()+ theme(axis.title.x = element_blank(),axis.text.x = element_text(size=9))+ gg_axis_x_label_angle()+
geom_path(data=data.frame(x=c(3,3,4,4),y=c(0.27,0.28,0.28,0.27)),aes(x,y)) + annotate("text",x=3.5,y=0.33,size=9/3,label= paste0("p=",signif(pval,2)))
p
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
resultCtrl
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
View(resultCtrl)
resultCtrl$mode2_ratio
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
View(resultCtrl)
resultCtrl$mode2_ratio
resultCtrl=lapply(wells,calcRatio)  %>% {do.call(rbind,.)} %>% as_data_frame() %>% mutate(.[[1]]=as.numeric(.[[1]]))
View(resultCtrl)
resultCtrl=lapply(wells,calcRatio)  %>% {do.call(rbind,.)} %>% as_data_frame() %>% mutate_at(vars(ends_with("ratio")), funs(as.numeric))
resultCtrl$mode2_ratio
resultCtrl$mode1_ratio
resultCtrl$TF
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
View(resultCtrl)
View(resultCtrl)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
View(resultCtrl)
View(resultT)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
View(resultCtrl)
View(resultT)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
resultCtrl
resultT
plotdf=rbind(resultCtrl,resultT) #%>% mutate(label=paste0(mode,"_",TF))
View(plotdf)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
p
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl_Individual.R', echo=TRUE)
View(plotdf)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
"~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2*_foldchn_maxBias.csv" %>% Sys.glob()
"~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[Io]*_foldchn_maxBias.csv" %>% Sys.glob()
"~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[(III)|(ooo)]*_foldchn_maxBias.csv" %>% Sys.glob()
"~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[(III)|(ooo)]*_foldchn_maxBias.csv" %>% Sys.glob()
TBX2Nu[1] %>% read_csv()
TBX2Nu="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[(III)|(ooo)]*_foldchn_maxBias.csv" %>% Sys.glob()
TBX2Nu[1] %>% read_csv()
TBX2Nu[1] %>% read_csv() %>% gg_heat2D_MI()
TBX2Nu[2] %>% read_csv() %>% gg_heat2D_MI()
TBX2Nu[3] %>% read_csv() %>% gg_heat2D_MI()
TBX2Nu[4] %>% read_csv() %>% gg_heat2D_MI()
TBX2Nu
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/other_TFs_ctrl.R', echo=TRUE)
p
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/other_TFs_ctrl.R', echo=TRUE)
p
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/other_TFs_ctrl.R', echo=TRUE)
p
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/other_TFs_ctrl.R', echo=TRUE)
p
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/other_TFs_ctrl.R', echo=TRUE)
well=M24
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
View(bound)
bound$pos2 %>% identical(unbound)
bound$pos2 %>% identical(unbound$pos2)
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=bound$topMIsum/unbound$topMIsum)
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(TEK-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(TEK-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="N16"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="N24"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="P8"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="P12"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="P8"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="O23"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
boundfile
well="P3"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="O21"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="G19"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="N16"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=c(-0.8,0.8), oob=scales::squish,values = c(0,0.5,1) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
well="N24"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(bound$topMIsum/unbound$topMIsum))
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=c(-0.8,0.8), oob=scales::squish,values = c(0,0.5,1) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
calcRatio <- function(well)
{
# well="N24"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(unbound$topMIsum/bound$topMIsum))
# c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
#   gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
#   theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
# print(c5_all_sig_free_Nu_diff_ratio)
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=c(-0.8,0.8), oob=scales::squish,values = c(0,0.5,1) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
return(c5_all_sig_free_Nu_diff_ratio)
}
calcRatio("N24")
calcRatio <- function(well)
{
# well="N24"
boundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*_foldchn_maxBias.csv") %>% Sys.glob()
unboundfile= paste0( "~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/",well,"_Trulig147v1IIIFJ4-5-CAP2r-147c5Free*_foldchn_maxBias.csv") %>% Sys.glob()
bound=boundfile %>% read_csv()
unbound=unboundfile %>% read_csv()
free_Nu_diff=bound %>% mutate(topMIsum=log2(unbound$topMIsum/bound$topMIsum))
# c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("#7dbb78","white","red"), limits=quantile(free_Nu_diff[[3]], c(0.01, 0.99)), oob=scales::squish,values = gg_gen_scale_with_quan(free_Nu_diff[[3]], 0.01, 0.99) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
#   gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
#   theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
# print(c5_all_sig_free_Nu_diff_ratio)
c5_all_sig_free_Nu_diff_ratio= ggbasic + stat_summary_2d(data = free_Nu_diff,aes_string("pos1","pos2",z=names(free_Nu_diff)[3]),fun = mean,binwidth = 1) + scale_fill_gradientn(name= expression("log"[2]*"(E-MI ratio)"),colors = c("green","white","red"), limits=c(-0.8,0.8), oob=scales::squish,values = c(0,0.5,1) )+ gg_bkcolor("white") + xlab("(bp)") + ylab("(bp)")+
gg_theme_Publication()+theme(panel.grid.major = element_line(size = 0.4,color="grey",linetype = "dashed"),panel.grid.minor = element_line(size = 0.4,color="grey",linetype = "dashed"))+
theme(legend.justification=c(1,0), legend.position=c(1,0))+scale_x_continuous(breaks = gg_breaks(free_Nu_diff$pos1,end_plus_middle = T),expand = c(0,0))+scale_y_continuous(breaks = gg_breaks(free_Nu_diff$pos2,end_plus_middle = T),expand = c(0,0))
print(c5_all_sig_free_Nu_diff_ratio)
return(c5_all_sig_free_Nu_diff_ratio)
}
calcRatio("N24")
wells=qw("M24 O23 P3 O21 G19 I16 P14 D22 P19 J2 G18 A16 B2 C19 C4 M7 A19 I8 B21 O6")
wells=qw("M24 O23 P3 O21 G19 I16 P14 D22 P19 J2 G18 A16 B2 C19 C4 M7 A19 I8 B21 O6")
resultCtrl=lapply(wells,calcRatio)
do.call(fjComm::gg_multiplot, resultCtrl,cols=7)
resultCtrl=lapply(wells,calcRatio); resultCtrl$col=7
do.call(fjComm::gg_multiplot, resultCtrl)
resultCtrl=lapply(wells,calcRatio);# resultCtrl$col=7
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
gg_multiplot(resultCtrl[[1]],resultCtrl[[2]],resultCtrl[[3]],resultCtrl[[4]])
gg_multiplot(resultCtrl[[1]],resultCtrl[[2]],resultCtrl[[3]],resultCtrl[[4]],cols = 2)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
gg_multiplot(resultCtrl[[1]],resultCtrl[[2]],resultCtrl[[3]],resultCtrl[[4]],cols = 2)
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
resultCtrl=lapply(wells,calcRatio); resultCtrl$col=7
names(resultCtrl)
resultCtrl=lapply(wells,calcRatio); resultCtrl$cols=7
gg_multiplot(resultCtrl[[1]],resultCtrl[[2]],resultCtrl[[3]],resultCtrl[[4]])
names(resultCtrl)
do.call(fjComm::gg_multiplot, resultCtrl)
gg_multiplot()
gg_multiplot
resultT=lapply(c("N16","N24","P8","P12"),calcRatio); resultT$cols=7
do.call(fjComm::gg_multiplot, resultT)
list(1,2)
list(1,2) %>% c(list(3))
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
p=do.call(fjComm::gg_multiplot, resultCtrl)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
pdf("ctrlTF_2d_EMI.pdf",width = 16,height = 14)
p=do.call(fjComm::gg_multiplot, resultCtrl)
dev.off()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
pdf("ctrlTF_2d_EMI.pdf",width = 15,height = 12)
do.call(fjComm::gg_multiplot, resultCtrl)
dev.off()
pdf("ctrlTF_2d_EMI.pdf",width = 15/2.54,height = 12/2.54)
do.call(fjComm::gg_multiplot, resultCtrl)
dev.off()
pdf("ctrlTF_2d_EMI.pdf",width = 20/2.54,height = 15/2.54)
do.call(fjComm::gg_multiplot, resultCtrl)
dev.off()
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/2D_plots.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(plotdf)
TBX2Nu="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[(III)|(ooo)]*_foldchn_maxBias.csv" %>% Sys.glob()
TBX2Nu[4] %>% read_csv() %>% gg_heat2D_MI()
TBX2Nu[1] %>% read_csv() %>% gg_heat2D_MI()
TBX2Nu="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[(III)|(ooo)]*_foldchn_maxBias.csv" %>% Sys.glob() %>% .[1:3]
TBX2Nu %>% lapply(extract_well)
TBX2Nu="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[(III)|(ooo)]*_foldchn_maxBias.csv" %>% Sys.glob() %>% .[1:3]
TBXwells=TBX2Nu %>% lapply(extract_well) %>% unlist()
TBX2Nu="~/Nut_zhuData/seqFiles2/FJ4.5CAP2r_PE/analysis/2d_IC_related_pub/data/*_Trulig147v1IIIFJ4-5-CAP2r-147c5Nu-*TBX2[(III)|(ooo)]*_foldchn_maxBias.csv" %>% Sys.glob() %>% .[1:3]
TBXwells=TBX2Nu %>% lapply(extract_well) %>% unlist()
resultTBX=lapply(TBXwells,calcRatio) %>% {do.call(rbind,.)} %>% as_data_frame() %>% mutate_at(vars(ends_with("ratio")), funs(as.numeric))%>% mutate(lable="TBX2")
plotdf=rbind(resultCtrl,resultT,resultTBX)
View(plotdf)
plotdf=rbind(resultCtrl,resultT,resultTBX) %>% mutate(diff=mode2_ratio-mode1_ratio)
View(plotdf)
View(plotdf)
bk_dist=plotdf$diff
bk_dist=plotdf$diff[1:20]
mean(bk_dist)
plotdf$diff[21]
plotdf$diff[21] %>% t.test(bk_dist)
t.test(bk_dist,mu=plotdf$diff[21])
t.test(bk_dist,mu=plotdf$diff[21],alternative = "greater")
t.test(bk_dist,mu=plotdf$diff[21],alternative = "smaller")
t.test(bk_dist,mu=plotdf$diff[21],alternative = "less")
t_test=t.test(bk_dist,mu=plotdf$diff[21],alternative = "less")
t_test$p.value
t_test$conf.int
t_test$conf.int[2]
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
t_test
t_test
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
alltests
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
alltests=rbind(alltests)
View(alltests)
alltests=as.data.frame(alltests)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(alltests)
alltests=as.data.frame(alltests) %>% t
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(alltests)
View(plotdf)
View(alltests)
t_test
plotdf$diff[i]
t.test(bk_dist,plotdf$diff[i])
t.test(plotdf$diff[i],bk_dist)
t.test(mu=bk_dist,plotdf$diff[i])
t.test(bk_dist,mu=plotdf$diff[i])
t.test(bk_dist,mu=plotdf$diff[1])
t.test(bk_dist,mu=plotdf$diff[2])
t.test(bk_dist,mu=plotdf$diff[2])$conf.int
t.test(bk_dist,mu=plotdf$diff[2])$conf.int
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(alltests)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
alltests
debugSource('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
t_test
i
t_test
t_test
t.test(bk_dist,mu=plotdf$diff[2])$conf.int
t.test(bk_dist,mu=plotdf$diff[3])$conf.int
t.test(bk_dist,mu=plotdf$diff[1])$conf.int
t.test(bk_dist,mu=plotdf$diff[1])
t.test(bk_dist,mu=plotdf$diff[2])
t.test(bk_dist,mu=plotdf$diff[5])
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(alltests)
alltests[[1]]
alltests[,1]
alltests=vector("numeric",27)
for (i in 1:27)
{
t_test=t.test(bk_dist,mu=plotdf$diff[i])
alltests[[i]]=c(p_value=t_test$p.value)
conf_interval=t_test$conf.int %>% paste0(collapse=" ~ ")
}
alltests=as.data.frame(alltests) %>% t
alltests
alltests=numeric(27)
for (i in 1:27)
{
t_test=t.test(bk_dist,mu=plotdf$diff[i])
alltests[[i]]=c(p_value=t_test$p.value)
conf_interval=t_test$conf.int %>% paste0(collapse=" ~ ")
}
alltests=as.data.frame(alltests) %>% t
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
alltests=numeric(27)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
alltests
t_test$p.value[1]
alltests %>% as.numeric()
alltests %>% as.numeric() %>% prettyNum(digits=2)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(plotdf)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
plotdf$mode2_ratio %>% round(2)
plotdf %>% mutate(mode2_ratio=round(mode2_ratio,2),mode1_ratio=round(mode1_ratio,2),diff=round(diff,4))
plotdf %<>% mutate(mode2_ratio=round(mode2_ratio,2),mode1_ratio=round(mode1_ratio,2),diff=round(diff,4))
View(plotdf)
plotdf %>% writeClipboard()
plotdf[[c(3,1,2,5,6)]]
plotdf %>% select(c(3,1,2,5,6))
plotdf1=plotdf %>% select(c(3,1,2,5,6)) %>% set_colnames(c("TF","E-MI ratio (Gs)","E-MI ratio (bk)","Diff.","p_value"))
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(plotdf)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
View(plotdf1)
source('~/Desktop/Nucleosome_manuscript/plotting_Scripts/fig7_scafold_effect/motif_of_T/2modes_ctrl_ref3/2D_plots/individual_TF_stat.R', echo=TRUE)
t_test
